# WeaveAI 2.0 é‡æ„ä¸å‡çº§è¿­ä»£è®¡åˆ’

> **ç‰ˆæœ¬**: 2.8  
> **åˆ›å»ºæ—¥æœŸ**: 2026-02-07  
> **æœ€åæ›´æ–°**: 2026-02-16  
> **ç›®æ ‡**: å¤š Agent åä½œå·¥ä½œæµå‡çº§ï¼ˆMarket Insight v2ï¼šå¹¶è¡Œæ”¶é›† + å¤šè½®è¾©è®º + ç»¼åˆæŠ¥å‘Š + SSE æµå¼ + æœ€å°è½åº“é—­ç¯ + åˆ›ä¸šæ¯”èµ›å¯æ¼”ç¤ºäº¤ä»˜ï¼‰

---

## ç›®å½•

1. [é¡¹ç›®ç°çŠ¶åˆ†æ](#ä¸€é¡¹ç›®ç°çŠ¶åˆ†æ)
2. [ç›®æ ‡æ¶æ„è®¾è®¡](#äºŒç›®æ ‡æ¶æ„è®¾è®¡)
3. [æŠ€æœ¯é€‰å‹](#ä¸‰æŠ€æœ¯é€‰å‹)
4. [åˆ†é˜¶æ®µè¿­ä»£è®¡åˆ’](#å››åˆ†é˜¶æ®µè¿­ä»£è®¡åˆ’)
5. [æ•°æ®æ¨¡å‹è®¾è®¡](#äº”æ•°æ®æ¨¡å‹è®¾è®¡)
6. [API è®¾è®¡](#å…­api-è®¾è®¡)
7. [é£é™©ä¸ç¼“è§£æªæ–½](#ä¸ƒé£é™©ä¸ç¼“è§£æªæ–½)
8. [éªŒæ”¶æ ‡å‡†](#å…«éªŒæ”¶æ ‡å‡†)

---

## ä¸€ã€é¡¹ç›®ç°çŠ¶åˆ†æ

### 1.1 å½“å‰æ¶æ„æ¦‚è§ˆ

```
å½“å‰æ¶æ„ï¼šWeaveAI 2.0ï¼ˆå¤š Agent + å¤šè½®è¾©è®º + SSEï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯ (Next.js 15 + React 19)                                â”‚
â”‚  â””â”€ å•å·¥ä½œæµï¼šProfile â†’ SSE å®æ—¶è¿›åº¦ â†’ ç»¼åˆæŠ¥å‘Šå±•ç¤º           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ SSE / JSON
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åç«¯ (FastAPI + LangGraph)                                  â”‚
â”‚  â”œâ”€ v2 API: /api/v2/market-insight/{stream|generate|status}   â”‚
â”‚  â”œâ”€ Orchestrator(GraphEngine): fan-out -> debate -> synth     â”‚
â”‚  â”œâ”€ Worker Agents(4): trend / competitor / regulation / socialâ”‚
â”‚  â”œâ”€ Debate: peer_review + red_team (å¯é…è½®æ•°ä¸ followup)       â”‚
â”‚  â””â”€ Synthesizer: æ±‡æ€»æœ€ç»ˆæŠ¥å‘Š                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ æœ€å°è½åº“ï¼ˆPhase 1ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœ¬åœ° Supabase/Postgresï¼ˆdocker-composeï¼‰                     â”‚
â”‚  â”œâ”€ sessions / agent_results / debate_exchanges / workflow_events
â”‚  â”œâ”€ tool_invocationsï¼ˆPhase 1 å»ºè¡¨ï¼ŒPhase 4 å®Œæ•´å®¡è®¡ï¼‰         â”‚
â”‚  â””â”€ å†™å…¥æ–¹å¼ï¼špsycopg2 ç›´è¿ + fire-and-forget é˜Ÿåˆ—             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 ç°æœ‰æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ | ç‰ˆæœ¬ |
|-----|------|------|
| å‰ç«¯æ¡†æ¶ | Next.js | 15.5.6 |
| UI åº“ | React | 19.1.0 |
| æ ·å¼ | Tailwind CSS | 3.4.18 |
| åç«¯æ¡†æ¶ | FastAPI | latest |
| ç¼–æ’å¼•æ“ | LangGraph | 1.0.x |
| AI/LLM | ç«å±±å¼•æ“ Ark Responses API | - |
| æ•°æ®åº“ | æœ¬åœ° Supabase/Postgresï¼ˆdocker-composeï¼‰ | - |
| ~~æœºå™¨å­¦ä¹ ~~ | ~~TensorFlow/Keras, scikit-learn~~ | âŒ åˆ é™¤ |

### 1.3 ç°æœ‰ Agent æ¶æ„é—®é¢˜è¯Šæ–­

| é—®é¢˜ç±»åˆ« | å…·ä½“è¡¨ç° | å½±å“ |
|---------|---------|-----|
| **çº¿æ€§è€¦åˆ** | ä¸‰ä¸ª Agent ä¸²è¡Œæ‰§è¡Œï¼Œæ— å¹¶è¡Œèƒ½åŠ› | å“åº”æ—¶é—´é•¿ï¼Œç”¨æˆ·ç­‰å¾… |
| **æ— åä½œæœºåˆ¶** | Agent ä¹‹é—´æ— é€šä¿¡ï¼Œä»…é€šè¿‡å‰ç«¯ä¸²è” | æ— æ³•äº¤å‰éªŒè¯ã€è¿­ä»£ä¼˜åŒ– |
| **æ— è¾©è®ºæœºåˆ¶** | Agent è¾“å‡ºç›´æ¥ä½œä¸ºæœ€ç»ˆç»“è®º | ç¼ºä¹å¤šè§’åº¦éªŒè¯ï¼Œç»“è®ºè´¨é‡ä¸ç¨³å®š |
| **Context éš”ç¦»ä¸è¶³** | æ¯ä¸ª Agent ç‹¬ç«‹ Promptï¼Œæ— å…±äº«è®°å¿† | ä¿¡æ¯æ–­å±‚ï¼Œé‡å¤è¾“å…¥ |
| **æ— çŠ¶æ€æŒä¹…åŒ–** | ä¼šè¯ç»“æŸåçŸ¥è¯†ä¸¢å¤± | æ— æ³•å­¦ä¹ ã€æ— æ³•å¤ç”¨ |
| **å·¥å…·è®¾è®¡è¿‡äºä¸“åŒ–** | åˆ†æå·¥å…·é«˜åº¦è€¦åˆæ•°æ®æ ¼å¼ | æ‰©å±•å›°éš¾ï¼Œç»´æŠ¤æˆæœ¬é«˜ |
| **ç¼ºä¹ç¼–æ’å±‚** | æ—  Supervisor/Orchestrator | æ— æ³•åŠ¨æ€è°ƒåº¦ã€é”™è¯¯æ¢å¤ |
| **æ•°æ®æºå•ä¸€** | ä»…ä¾èµ–é€šç”¨ web_search | ç¼ºä¹ç¤¾äº¤èˆ†æƒ…ç­‰å¤šå…ƒæ•°æ® |

### 1.4 æŠ€æœ¯å€ºåŠ¡æ¸…å•

| æ–‡ä»¶/æ¨¡å— | é—®é¢˜ | å¤„ç†æ–¹å¼ |
|----------|------|---------|
| `frontend/app/page.js` | 15+ useStateï¼ŒçŠ¶æ€åˆ†æ•£ | Context + Reducer |
| æµå¼å¤„ç† | æ‰‹åŠ¨è§£ææ ‡è®°ç¬¦ï¼Œç¼ºä¹ç»Ÿä¸€åè®® | ç»Ÿä¸€ SSE åè®® |
| é”™è¯¯å¤„ç† | Agent å¤±è´¥åæ— é‡è¯•/é™çº§æœºåˆ¶ | ç¼–æ’å±‚å¤„ç† |
| æ•°æ®æŒä¹…åŒ– | åˆ†æç»“æœä»…æ–‡ä»¶å­˜å‚¨ï¼Œæ— æ³•æŸ¥è¯¢ | Supabase |
| ~~LSTM/KMeans æ¨¡å—~~ | ~~æ•ˆæœä¸ä½³ï¼Œä¸ç¬¦åˆä½¿ç”¨åœºæ™¯~~ | âŒ åˆ é™¤ |

### 1.5 èŒƒå›´è°ƒæ•´è¯´æ˜

> **é‡è¦å˜æ›´**ï¼šç»è¯„ä¼°ï¼ŒåŸ Data Validation Swarmï¼ˆé”€å”®é¢„æµ‹ã€å•†å“èšç±»ã€å¼‚å¸¸æ£€æµ‹ã€æƒ…æ„Ÿåˆ†æï¼‰ä¸ç¬¦åˆå®é™…ä½¿ç”¨åœºæ™¯ï¼Œ**å·²ä»è¿­ä»£èŒƒå›´ä¸­åˆ é™¤**ã€‚
>
> **å½“å‰èŒƒå›´**ï¼šä»“åº“ä¸“æ³¨ WeaveAI 2.0ï¼ˆMarket Insight v2ï¼‰å®ç°ï¼Œä¸å†ä¿ç•™ v1 å…¼å®¹ä»£ç ã€‚
>
> **Phase 1 é‡ç‚¹**ï¼šæ¨¡å—åŒ–åç«¯ç»“æ„ã€BaseAgentã€v2 SSE äº‹ä»¶åè®®ã€IGraphEngine æ¥å£ã€ä»¥åŠâ€œæœ€å°è½åº“é—­ç¯â€ï¼ˆsessions/agent_results/debate_exchanges/workflow_eventsï¼‰ã€‚

---

## äºŒã€ç›®æ ‡æ¶æ„è®¾è®¡

### 2.1 Supervisor-Worker + Debate æ··åˆæ¨¡å¼

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚            WeaveAI Orchestrator            â”‚
                    â”‚    (Supervisor Agent - ä¸­å¤®è°ƒåº¦å™¨)          â”‚
                    â”‚  â€¢ ä»»åŠ¡åˆ†è§£ â€¢ è·¯ç”±å†³ç­– â€¢ è¾©è®ºåè°ƒ â€¢ ç»“æœèšåˆ â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                                                   â”‚
            â–¼                                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Market Intelligence Swarm   â”‚             â”‚   Strategy Synthesis Swarm    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚             â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Trend   â”‚  â”‚ Competitor â”‚  â”‚             â”‚  â”‚Strategic â”‚  â”‚  Risk    â”‚   â”‚
â”‚  â”‚ Scout   â”‚  â”‚  Analyst   â”‚  â”‚             â”‚  â”‚ Planner  â”‚  â”‚Evaluator â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â”‚             â”‚         â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚Regulationâ”‚ â”‚  Social    â”‚  â”‚  â† æ–°å¢
â”‚  â”‚ Checker â”‚  â”‚ Sentinel   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚       â”‚                       â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                   â–¼                         
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             
â”‚  â”‚    DebateCoordinator       â”‚  â† æ–°å¢ï¼šå¤šè½®è¾©è®ºæœºåˆ¶
â”‚  â”‚   â€¢ Round 1: ç‹¬ç«‹åˆ†æ      â”‚
â”‚  â”‚   â€¢ Round 2: äº¤å‰è´¨ç–‘      â”‚
â”‚  â”‚   â€¢ Round 3: å›åº”è¾©æŠ¤      â”‚
â”‚  â”‚   â€¢ Round 4: å…±è¯†å½¢æˆ      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ToolRegistry (ç»Ÿä¸€å·¥å…·å±‚)    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚web_searchâ”‚ â”‚ reddit_api â”‚  â”‚
â”‚  â”‚(ç«å±±å¼•æ“)â”‚ â”‚  (PRAW)    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  RateLimiter (é™æµ 5 QPS)  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Shared Memory Layer      â”‚
â”‚  â€¢ Entity Graph (çŸ¥è¯†å›¾è°±)    â”‚
â”‚  â€¢ Session State (ä¼šè¯ä¸Šä¸‹æ–‡) â”‚
â”‚  â€¢ Supabase (æŒä¹…åŒ–)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Agent è§’è‰²å®šä¹‰

| Agent åç§° | èŒè´£ | å·¥å…·é›† | è¾“å…¥ | è¾“å‡º |
|-----------|------|-------|-----|------|
| **Orchestrator** | ä»»åŠ¡åˆ†è§£ã€è·¯ç”±ã€è¾©è®ºåè°ƒã€èšåˆã€é”™è¯¯æ¢å¤ | LangGraph ç¼–æ’ | ç”¨æˆ·ç”»åƒ + é…ç½® | æœ€ç»ˆæŠ¥å‘Š |
| **TrendScout** | å¸‚åœºè¶‹åŠ¿ç ”ç©¶ | Ark `web_search`ï¼ˆå¯é€‰ï¼‰ | ç›®æ ‡å¸‚åœº/å“ç±» | è¶‹åŠ¿æ´å¯Ÿ |
| **CompetitorAnalyst** | ç«å“åˆ†æ | Ark `web_search`ï¼ˆå¯é€‰ï¼‰ | ç›®æ ‡å¸‚åœº/å“ç±» | ç«å“çŸ©é˜µ |
| **RegulationChecker** | æ³•è§„åˆè§„æ£€æŸ¥ | Ark `web_search`ï¼ˆå¯é€‰ï¼‰ | ç›®æ ‡å¸‚åœº/å“ç±» | åˆè§„æ¸…å• |
| **SocialSentinel** | èˆ†æƒ…ä¸ç”¨æˆ·å£°éŸ³é‡‡é›† | Ark `web_search`ï¼ˆå¯é€‰ï¼‰ | ç›®æ ‡å¸‚åœº/å“ç±» | èˆ†æƒ…æ‘˜è¦ |
| **DebateChallenger** | çº¢é˜Ÿè´¨ç–‘ï¼ˆæ‰¹åˆ¤å®¡æŸ¥ï¼‰ | å†…éƒ¨è°ƒåº¦ | å…¶ä»– Agent è¾“å‡º | è´¨ç–‘ç‚¹ |
| **Synthesizer** | ç»¼åˆåˆ†æä¸æœ€ç»ˆæŠ¥å‘Šç”Ÿæˆ | å†…éƒ¨è°ƒåº¦ | å…¨éƒ¨ç»“æœ + è¾©è®ºè®°å½• | ç»¼åˆæŠ¥å‘Š |


### 2.3 Agent-Model æ˜ å°„é…ç½®

> **è®¾è®¡åŸåˆ™**ï¼šæ ¹æ®æ¯ä¸ª Agent çš„èŒè´£ç‰¹æ€§ï¼Œé€‰æ‹©æœ€é€‚åˆçš„æ¨¡å‹ã€‚

| Agent åç§° | æ¨¡å‹ ID | é€‰æ‹©ç†ç”± |
|-----------|---------|----------|
| **TrendScout** (è¶‹åŠ¿ä¾¦å¯Ÿå‘˜) | `doubao-seed-2-0-pro-260215` | 2.0æ——èˆ°å¤šæ¨¡æ€é€šç”¨ + å¼ºè”ç½‘æœç´¢ + å‘æ•£è”æƒ³èƒ½åŠ›å¼º |
| **CompetitorAnalyst** (ç«äº‰åˆ†æå¸ˆ) | `deepseek-v3-2-251201` | é€»è¾‘æ¨ç†å¼º + ç»“æ„åŒ–åˆ†æèƒ½åŠ›ä¼˜ç§€ |
| **RegulationChecker** (æ³•è§„æ£€æŸ¥å‘˜) | `kimi-k2-thinking-251104` | é•¿æ–‡æ¡£é˜…è¯» + Thinking æ¨¡å¼æ·±åº¦æ¨ç† |
| **SocialSentinel** (ç¤¾åª’å“¨å…µ) | `doubao-seed-2-0-pro-260215` | 2.0æ——èˆ°å¤šæ¨¡æ€é€šç”¨ + ä¸­æ–‡è¯­æ„Ÿä½³ + æƒ…æ„Ÿç†è§£èƒ½åŠ›å¼º |
| **Synthesizer** (ç»¼åˆåˆ†æå¸ˆ) | `kimi-k2-thinking-251104` | è¶…é•¿ä¸Šä¸‹æ–‡ + ä¸ä¸¢ç»†èŠ‚ + æ·±åº¦æ•´åˆ |
| **DebateChallenger** (è¾©è®ºè´¨ç–‘æ–¹) | `deepseek-v3-2-251201` | æ‰¹åˆ¤æ€§æ€ç»´ + é€»è¾‘åé©³èƒ½åŠ›å¼º |

### 2.4 Agent è§’è‰²è¯¦ç»†è®¾å®š

#### 2.4.1 TrendScout (è¶‹åŠ¿ä¾¦å¯Ÿå‘˜)

```
ä½ æ˜¯ã€è¶‹åŠ¿ä¾¦å¯Ÿå‘˜ã€‘ï¼Œä¸“æ³¨äºå‘ç°å¸‚åœºæ–°å…´è¶‹åŠ¿å’Œæœºä¼šçª—å£ã€‚

ã€æ ¸å¿ƒèŒè´£ã€‘
- è¯†åˆ«æ–°å…´è¶‹åŠ¿ï¼šæŠ€æœ¯å˜é©ã€æ¶ˆè´¹å‡çº§ã€æ”¿ç­–é£å‘
- è¯„ä¼°è¶‹åŠ¿æˆç†Ÿåº¦ï¼šèŒèŠ½æœŸ / æˆé•¿æœŸ / æˆç†ŸæœŸ / è¡°é€€æœŸ
- å‘ç°è“æµ·æœºä¼šï¼šæœªè¢«å……åˆ†å¼€å‘çš„ç»†åˆ†å¸‚åœº
- é¢„è­¦é¢ è¦†æ€§å˜åŒ–ï¼šå¯èƒ½æ”¹å˜è¡Œä¸šæ ¼å±€çš„ä¿¡å·

ã€åˆ†æç»´åº¦ã€‘
- æŠ€æœ¯è¶‹åŠ¿ï¼šæ–°æŠ€æœ¯åº”ç”¨ã€ä¸“åˆ©åŠ¨æ€ã€ç ”å‘æŠ•å…¥
- æ¶ˆè´¹è¶‹åŠ¿ï¼šç”¨æˆ·è¡Œä¸ºå˜åŒ–ã€éœ€æ±‚å‡çº§ã€åå¥½è¿ç§»
- æ”¿ç­–è¶‹åŠ¿ï¼šç›‘ç®¡æ–¹å‘ã€æ‰¶æŒæ”¿ç­–ã€è´¸æ˜“ç¯å¢ƒ
- ç«äº‰è¶‹åŠ¿ï¼šè¡Œä¸šæ•´åˆã€æ–°è¿›å…¥è€…ã€å•†ä¸šæ¨¡å¼åˆ›æ–°

ã€è¾“å‡ºè¦æ±‚ã€‘
- æ¯ä¸ªè¶‹åŠ¿æ ‡æ³¨ï¼šå¯ä¿¡åº¦(é«˜/ä¸­/ä½) + æ—¶é—´çª—å£(çŸ­æœŸ/ä¸­æœŸ/é•¿æœŸ) + æ•°æ®æ¥æº
- åŒºåˆ†å·²éªŒè¯è¶‹åŠ¿ vs æ—©æœŸä¿¡å·
- æä¾›å¯æ“ä½œçš„æœºä¼šå»ºè®®
```

#### 2.4.2 CompetitorAnalyst (ç«äº‰åˆ†æå¸ˆ)

```
ä½ æ˜¯ã€ç«äº‰åˆ†æå¸ˆã€‘ï¼Œä¸“æ³¨äºç«äº‰æ ¼å±€åˆ†æå’Œç«å“ç ”ç©¶ã€‚

ã€æ ¸å¿ƒèŒè´£ã€‘
- ç»˜åˆ¶ç«äº‰æ ¼å±€ï¼šè¯†åˆ«ä¸»è¦ç©å®¶ã€å¸‚åœºä»½é¢ã€ç«äº‰æ€åŠ¿
- å‰–æç«å“ç­–ç•¥ï¼šå®šä»·ã€æ¸ é“ã€è¥é”€ã€äº§å“å·®å¼‚åŒ–
- è¯†åˆ«å·®å¼‚åŒ–æœºä¼šï¼šç«å“æœªè¦†ç›–çš„éœ€æ±‚ç‚¹
- è¯„ä¼°è¿›å…¥å£å’ï¼šæŠ€æœ¯å£å’ã€èµ„é‡‘å£å’ã€å“ç‰Œå£å’

ã€åˆ†ææ¡†æ¶ã€‘
- ç«å“çŸ©é˜µï¼šåŠŸèƒ½å¯¹æ¯”ã€ä»·æ ¼åŒºé—´ã€ç›®æ ‡å®¢ç¾¤
- SWOT åˆ†æï¼šæ¯ä¸ªä¸»è¦ç«å“çš„ä¼˜åŠ£åŠ¿æœºä¼šå¨èƒ
- ç«äº‰ç­–ç•¥è¯†åˆ«ï¼šæˆæœ¬é¢†å…ˆ / å·®å¼‚åŒ– / èšç„¦
- åŠ¨æ€è·Ÿè¸ªï¼šæœ€è¿‘ 6 ä¸ªæœˆçš„é‡å¤§åŠ¨ä½œ

ã€è¾“å‡ºè¦æ±‚ã€‘
- ç»“æ„åŒ–çš„ç«å“å¯¹æ¯”è¡¨
- æ¯ä¸ªç»“è®ºæ ‡æ³¨æ•°æ®æ¥æºå’Œæ—¶æ•ˆæ€§
- ç»™å‡ºé¿å¼€å¼ºæ•Œå’Œå¼¯é“è¶…è½¦çš„å…·ä½“å»ºè®®
```

#### 2.4.3 RegulationChecker (æ³•è§„æ£€æŸ¥å‘˜)

```
ä½ æ˜¯ã€æ³•è§„æ£€æŸ¥å‘˜ã€‘ï¼Œä¸“æ³¨äºåˆè§„é£é™©å®¡æŸ¥å’Œæ”¿ç­–è§£è¯»ã€‚

ã€æ ¸å¿ƒèŒè´£ã€‘
- è¯†åˆ«æ³•è§„è¦æ±‚ï¼šé€‚ç”¨çš„æ³•å¾‹æ³•è§„ã€æ ‡å‡†è§„èŒƒ
- è¯„ä¼°åˆè§„æˆæœ¬ï¼šè®¤è¯è´¹ç”¨ã€æ—¶é—´æˆæœ¬ã€æ”¹é€ æˆæœ¬
- é¢„è­¦æ”¿ç­–å˜åŒ–ï¼šå³å°†ç”Ÿæ•ˆçš„æ–°è§„ã€æ­£åœ¨è®¨è®ºçš„è‰æ¡ˆ
- æä¾›åˆè§„è·¯å¾„ï¼šåˆ†æ­¥éª¤çš„åˆè§„å®æ–½å»ºè®®

ã€å®¡æŸ¥èŒƒå›´ã€‘
- è¡Œä¸šå‡†å…¥ï¼šèµ„è´¨è¦æ±‚ã€è®¸å¯è¯ã€å¤‡æ¡ˆç™»è®°
- äº§å“åˆè§„ï¼šå®‰å…¨è®¤è¯ã€ç¯ä¿è¦æ±‚ã€æ ‡ç­¾è§„èŒƒ
- è·¨å¢ƒåˆè§„ï¼šæµ·å…³æ”¿ç­–ã€å…³ç¨ç¨ç‡ã€è¿›å‡ºå£é™åˆ¶
- æ•°æ®åˆè§„ï¼šæ•°æ®ä¿æŠ¤ã€éšç§æ”¿ç­–ã€è·¨å¢ƒä¼ è¾“

ã€è¾“å‡ºè¦æ±‚ã€‘
- å¼•ç”¨å…·ä½“æ³•è§„æ¡æ¬¾å’Œæ–‡å·
- åŒºåˆ†å¼ºåˆ¶æ€§è¦æ±‚ vs å»ºè®®æ€§æŒ‡å—
- è¯„ä¼°è¿è§„åæœï¼ˆç½šæ¬¾é‡‘é¢ã€ä¸šåŠ¡å½±å“ï¼‰
- æŒ‰ç´§è¿«ç¨‹åº¦æ’åºåˆè§„äº‹é¡¹
```

#### 2.4.4 SocialSentinel (ç¤¾åª’å“¨å…µ)

```
ä½ æ˜¯ã€ç¤¾åª’å“¨å…µã€‘ï¼Œä¸“æ³¨äºèˆ†æƒ…ç›‘æµ‹å’Œæ¶ˆè´¹è€…æ´å¯Ÿã€‚

ã€æ ¸å¿ƒèŒè´£ã€‘
- æ•æ‰èˆ†è®ºçƒ­ç‚¹ï¼šå½“å‰è®¨è®ºçƒ­åº¦æœ€é«˜çš„è¯é¢˜
- åˆ†æå£ç¢‘è¯„ä»·ï¼šæ­£é¢/ä¸­æ€§/è´Ÿé¢æƒ…æ„Ÿåˆ†å¸ƒ
- è¯†åˆ« KOL åˆ†å¸ƒï¼šå½±å“åŠ›äººç‰©å’Œæ„è§é¢†è¢–
- é¢„è­¦èˆ†è®ºé£é™©ï¼šæ½œåœ¨çš„è´Ÿé¢äº‹ä»¶å’Œå…¬å…³å±æœº

ã€ç›‘æµ‹ç»´åº¦ã€‘
- èˆ†æƒ…çƒ­åº¦ï¼šè®¨è®ºé‡ã€äº’åŠ¨é‡ã€ä¼ æ’­é€Ÿåº¦
- æ¶ˆè´¹è€…ç—›ç‚¹ï¼šé«˜é¢‘æŠ±æ€¨ã€æœªæ»¡è¶³éœ€æ±‚
- å£ç¢‘åˆ†æï¼šäº§å“è¯„ä»·ã€å“ç‰Œè®¤çŸ¥ã€è´­ä¹°æ„æ„¿
- ä¼ æ’­ç”Ÿæ€ï¼šä¸»è¦è®¨è®ºå¹³å°ã€ä¼ æ’­è·¯å¾„

ã€è¾“å‡ºè¦æ±‚ã€‘
- æ ‡æ³¨ä¿¡æ¯æ¥æºå’Œé‡‡é›†æ—¶é—´
- åŒºåˆ†æ­£é¢ / ä¸­æ€§ / è´Ÿé¢è¯„ä»·
- è¯†åˆ«çœŸå®ç”¨æˆ·å£°éŸ³ vs å¯èƒ½çš„æ°´å†›/è¥é”€å†…å®¹
- æä¾›èˆ†æƒ…åº”å¯¹å»ºè®®
```

#### 2.4.5 Synthesizer (ç»¼åˆåˆ†æå¸ˆ)

```
ä½ æ˜¯ã€ç»¼åˆåˆ†æå¸ˆã€‘ï¼Œè´Ÿè´£æ•´åˆå¤šä½ä¸“å®¶çš„åˆ†æå¹¶å½¢æˆæœ€ç»ˆæŠ¥å‘Šã€‚

ã€æ ¸å¿ƒèŒè´£ã€‘
- æ•´åˆå››ä¸ªç»´åº¦ï¼šè¶‹åŠ¿ã€ç«äº‰ã€æ³•è§„ã€èˆ†æƒ…
- è¯†åˆ«å…³è”å’ŒçŸ›ç›¾ï¼šä¸åŒåˆ†æä¹‹é—´çš„é€»è¾‘å…³ç³»
- å½¢æˆä¸€è‡´æ€§å»ºè®®ï¼šç»¼åˆå„æ–¹è§‚ç‚¹çš„è¡ŒåŠ¨æ–¹æ¡ˆ
- æ ‡æ³¨å…±è¯†ä¸åˆ†æ­§ï¼šæ˜ç¡®å“ªäº›ç»“è®ºå·²è¾¾æˆå…±è¯†ã€å“ªäº›ä»æœ‰äº‰è®®

ã€æŠ¥å‘Šç»“æ„ã€‘
1. æ‰§è¡Œæ‘˜è¦ï¼š3-5 ä¸ªæ ¸å¿ƒç»“è®º + æ€»ä½“å»ºè®®
2. æœºä¼šåˆ†æï¼šæŒ‰ä¼˜å…ˆçº§æ’åºçš„å¸‚åœºæœºä¼š
3. é£é™©æç¤ºï¼šéœ€è¦å…³æ³¨çš„æ½œåœ¨é£é™©
4. è¡ŒåŠ¨å»ºè®®ï¼šçŸ­æœŸ / ä¸­æœŸ / é•¿æœŸè¡ŒåŠ¨æ¸…å•
5. é™„å½•ï¼šæ•°æ®æ¥æºæ±‡æ€» + åˆ†æ­§ç‚¹è¯´æ˜

ã€è¾“å‡ºè¦æ±‚ã€‘
- æ¯ä¸ªç»“è®ºæ ‡æ³¨æ¥æº Agent
- çŸ›ç›¾è§‚ç‚¹å¹¶åˆ—å‘ˆç°ï¼Œä¸å¼ºè¡Œç»Ÿä¸€
- ç»™å‡ºç½®ä¿¡åº¦è¯„ä¼°ï¼ˆé«˜/ä¸­/ä½ï¼‰
- è¯­è¨€ç®€æ´ã€ç»“è®ºå¯æ“ä½œ
```

#### 2.4.6 DebateChallenger (çº¢é˜Ÿå®¡æŸ¥å®˜)

```
ä½ æ˜¯ã€çº¢é˜Ÿå®¡æŸ¥å®˜ã€‘ï¼ŒèŒè´£æ˜¯å¯¹åˆ†ææŠ¥å‘Šè¿›è¡Œæ‰¹åˆ¤æ€§å®¡æŸ¥ã€‚

ã€è´¨ç–‘ç»´åº¦ã€‘
- æ•°æ®å¯é æ€§ï¼šæ•°æ®æ¥æºæ˜¯å¦æƒå¨ï¼Ÿæ—¶æ•ˆæ€§å¦‚ä½•ï¼Ÿæ ·æœ¬æ˜¯å¦è¶³å¤Ÿï¼Ÿ
- é€»è¾‘ä¸¥å¯†æ€§ï¼šæ¨ç†è¿‡ç¨‹æ˜¯å¦æœ‰è·³è·ƒï¼Ÿå› æœå…³ç³»æ˜¯å¦æˆç«‹ï¼Ÿ
- è¦†ç›–å®Œæ•´æ€§ï¼šæ˜¯å¦é—æ¼äº†é‡è¦è§†è§’ï¼Ÿæ˜¯å¦è€ƒè™‘äº†è¾¹ç¼˜æƒ…å†µï¼Ÿ
- åè§æ£€æµ‹ï¼šæ˜¯å¦å­˜åœ¨ç¡®è®¤åè¯¯ï¼Ÿæ˜¯å¦è¿‡åº¦ä¹è§‚/æ‚²è§‚ï¼Ÿ

ã€è´¨ç–‘æ¨¡å¼ã€‘
- é’ˆå¯¹å…·ä½“è§‚ç‚¹æå‡ºåä¾‹æˆ–æ›¿ä»£è§£é‡Š
- è¦æ±‚è¡¥å……ç¼ºå¤±çš„æ•°æ®æˆ–è®ºè¯
- æŒ‡å‡ºéšå«å‡è®¾å’Œæ½œåœ¨é£é™©
- å»ºè®®è¿›ä¸€æ­¥éªŒè¯çš„æ–¹å‘

ã€è¾“å‡ºæ ¼å¼ã€‘
æ¯æ¡è´¨ç–‘åŒ…å«ï¼š
1. é’ˆå¯¹çš„å…·ä½“è§‚ç‚¹ï¼ˆå¼•ç”¨åŸæ–‡ï¼‰
2. è´¨ç–‘ç†ç”±ï¼ˆä¸ºä»€ä¹ˆè®¤ä¸ºæœ‰é—®é¢˜ï¼‰
3. å»ºè®®è¡¥å……ï¼ˆéœ€è¦ä»€ä¹ˆä¿¡æ¯æ¥éªŒè¯ï¼‰
```

### 2.5 å¤šè½®è¾©è®ºï¼ˆDebateï¼‰æœºåˆ¶è®¾è®¡

> **æ ¸å¿ƒè®¾è®¡**ï¼š2 è½®è¾©è®º + äºŒæ¬¡å›åº”æœºåˆ¶ï¼Œæ€»è®¡çº¦ 29 æ¬¡ API è°ƒç”¨

#### 2.5.1 è¾©è®ºæµç¨‹æ¦‚è§ˆ

```
Phase 1: å¹¶è¡Œæ”¶é›† (4 æ¬¡è°ƒç”¨)
  â”œâ”€ TrendScout ç‹¬ç«‹åˆ†æ
  â”œâ”€ CompetitorAnalyst ç‹¬ç«‹åˆ†æ
  â”œâ”€ RegulationChecker ç‹¬ç«‹åˆ†æ
  â””â”€ SocialSentinel ç‹¬ç«‹åˆ†æ
              â”‚
              â–¼
Round 1: åŒè¡Œè¯„å®¡ (12 æ¬¡è°ƒç”¨ï¼Œå«äºŒæ¬¡å›åº”)
  â”Œâ”€ é…å¯¹ A: TrendScout â†” CompetitorAnalyst
  â”‚   â”œâ”€ TS è´¨ç–‘ CA â†’ CA å›åº” â†’ TS ç¡®è®¤/è¿½é—®
  â”‚   â””â”€ CA è´¨ç–‘ TS â†’ TS å›åº” â†’ CA ç¡®è®¤/è¿½é—®
  â”‚
  â””â”€ é…å¯¹ B: RegulationChecker â†” SocialSentinel
      â”œâ”€ RC è´¨ç–‘ SS â†’ SS å›åº” â†’ RC ç¡®è®¤/è¿½é—®
      â””â”€ SS è´¨ç–‘ RC â†’ RC å›åº” â†’ SS ç¡®è®¤/è¿½é—®
              â”‚
              â–¼
Round 2: çº¢é˜Ÿå®¡æŸ¥ (12 æ¬¡è°ƒç”¨ï¼Œå«äºŒæ¬¡å›åº”)
  DeepSeek çº¢é˜Ÿé€ä¸€å®¡æŸ¥ 4 ä¸ª Agent:
  â”œâ”€ è´¨ç–‘ TrendScout â†’ TS å›åº” â†’ çº¢é˜Ÿç¡®è®¤/è¿½é—®
  â”œâ”€ è´¨ç–‘ CompetitorAnalyst â†’ CA å›åº” â†’ çº¢é˜Ÿç¡®è®¤/è¿½é—®
  â”œâ”€ è´¨ç–‘ RegulationChecker â†’ RC å›åº” â†’ çº¢é˜Ÿç¡®è®¤/è¿½é—®
  â””â”€ è´¨ç–‘ SocialSentinel â†’ SS å›åº” â†’ çº¢é˜Ÿç¡®è®¤/è¿½é—®
              â”‚
              â–¼
Phase 3: ç»¼åˆæŠ¥å‘Š (1 æ¬¡è°ƒç”¨)
  â””â”€ Synthesizer æ•´åˆæ‰€æœ‰å†…å®¹ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š

æ€»è®¡: çº¦ 29 æ¬¡ API è°ƒç”¨
```

#### 2.5.2 è¾©è®ºé…å¯¹è§„åˆ™

| è¾©è®ºè½®æ¬¡ | é…å¯¹å…³ç³» | è´¨ç–‘æ–¹å‘ | è®¾è®¡ç†ç”± |
|---------|---------|---------|---------|
| Round 1 | TS â†” CA | è¶‹åŠ¿ vs ç«äº‰ | å®è§‚è¶‹åŠ¿ä¸å¾®è§‚ç«äº‰çš„äº’è¡¥éªŒè¯ |
| Round 1 | RC â†” SS | æ³•è§„ vs èˆ†æƒ… | æ”¿ç­–å½±å“ä¸å¸‚åœºåé¦ˆçš„äº¤å‰æ£€éªŒ |
| Round 2 | çº¢é˜Ÿ â†’ å…¨éƒ¨ | ç‹¬ç«‹å®¡æŸ¥ | æ‰¹åˆ¤æ€§æ€ç»´å‘ç°ç›²ç‚¹ |

#### 2.5.3 äºŒæ¬¡å›åº”æœºåˆ¶

æ¯è½®è¾©è®ºåŒ…å«ä¸‰æ­¥äº¤äº’ï¼š

```
Step 1: è´¨ç–‘æ–¹æå‡ºè´¨ç–‘
  â””â”€ "ä½ è¯´å¸‚åœºå¢é•¿15%ï¼Œä½†ç«å“Xåœ¨æ”¶ç¼©ï¼Œå¦‚ä½•è§£é‡Šï¼Ÿ"

Step 2: è¢«è´¨ç–‘æ–¹å›åº”
  â””â”€ "ç«å“Xæ”¶ç¼©æ˜¯ä¾›åº”é“¾é—®é¢˜ï¼Œæ•´ä½“å¸‚åœºæ•°æ®æ¥æºäº..."
  â””â”€ å¯é€‰ï¼šä¿®æ­£åŸæœ‰ç»“è®º (revised: true)

Step 3: è´¨ç–‘æ–¹ç¡®è®¤/è¿½é—®
  â””â”€ ç¡®è®¤ï¼š"æ¥å—è§£é‡Šï¼Œä¿ç•™åŸç»“è®º"
  â””â”€ è¿½é—®ï¼š"ä¾›åº”é“¾é—®é¢˜æ˜¯å¦ä¼šæ‰©æ•£åˆ°æ•´ä¸ªè¡Œä¸šï¼Ÿ"
```

#### 2.5.4 è¾©è®ºçŠ¶æ€æœº

```
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                                         â”‚
           â–¼                                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â”‚  CHALLENGE  â”‚â”€â”€â”€â”€â–¶â”‚   RESPOND   â”‚â”€â”€â”€â”€â–¶â”‚   CONFIRM   â”‚
    â”‚  (è´¨ç–‘)     â”‚     â”‚   (å›åº”)    â”‚     â”‚  (ç¡®è®¤/è¿½é—®) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                         â”‚
           â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  ESCALATE   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚  (å‡çº§)     â”‚   è‹¥è¿ç»­è¿½é—®è¶…è¿‡2æ¬¡
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                     äº¤ç”± Synthesizer è£å†³
```

#### 2.5.5 åŸå§‹ç¤ºæ„å›¾ï¼ˆä¿ç•™å‚è€ƒï¼‰

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â”‚  Round 1ï¼šç‹¬ç«‹åˆ†æ                                                  â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TrendScout          CompetitorAnalyst      RegulationChecker      SocialSentinel
   "å¸‚åœºè¶‹åŠ¿..."        "ç«å“åˆ†æ..."          "æ³•è§„è¦æ±‚..."          "ç¤¾äº¤èˆ†æƒ…..."
        â”‚                     â”‚                     â”‚                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â”‚  Round 2ï¼šäº¤å‰è´¨ç–‘                                                  â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CompetitorAnalyst â†’ TrendScout:
   "ä½ è¯´å¾·å›½å¸‚åœºå¢é•¿ 15%ï¼Œä½†æˆ‘å‘ç°ç«å“ X æ­£åœ¨æ”¶ç¼©ï¼Œæ˜¯å¦çŸ›ç›¾ï¼Ÿ"
   
   SocialSentinel â†’ CompetitorAnalyst:
   "Reddit ä¸Šç”¨æˆ·å¯¹ç«å“ Y çš„è¯„ä»·å¾ˆå·®ï¼Œä½ çš„åˆ†ææ˜¯å¦è€ƒè™‘äº†è¿™ç‚¹ï¼Ÿ"
   
   TrendScout â†’ RegulationChecker:
   "æ–°æ³•è§„å¯¹æ¶ˆè´¹è¶‹åŠ¿çš„å½±å“ä½ å¦‚ä½•è¯„ä¼°ï¼Ÿ"
                                        
                                        â–¼
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â”‚  Round 3ï¼šå›åº”ä¸è¾©æŠ¤                                                â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TrendScout å›åº”:
   "ç«å“ X æ”¶ç¼©æ˜¯å› ä¸ºä¾›åº”é“¾é—®é¢˜ï¼Œæ•´ä½“å¸‚åœºä»åœ¨å¢é•¿ï¼Œæ•°æ®æ¥æº..."
   
   CompetitorAnalyst ä¿®æ­£:
   "æ¥å— SocialSentinel çš„åé¦ˆï¼Œå°†ç«å“ Y çš„ç”¨æˆ·å£ç¢‘çº³å…¥åˆ†æ..."
                                        â”‚
                                        â–¼
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â”‚  Round 4ï¼šå…±è¯†å½¢æˆ                                                  â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DebateCoordinator ç»¼åˆè¾“å‡º:
   â”œâ”€ å…±è¯†ç»“è®ºï¼ˆæ‰€æœ‰ Agent è®¤åŒçš„ç‚¹ï¼‰
   â”œâ”€ åˆ†æ­§æ ‡æ³¨ï¼ˆä»å­˜äº‰è®®çš„ç‚¹ï¼Œä¾›ç”¨æˆ·å†³ç­–ï¼‰
   â”œâ”€ ç½®ä¿¡åº¦è¯„åˆ†ï¼ˆåŸºäºè¯æ®å……åˆ†æ€§ï¼‰
   â””â”€ æ•°æ®æº¯æºï¼ˆæ¯ä¸ªç»“è®ºçš„æ¥æº Agent ä¸å·¥å…·ï¼‰
```

### 2.6 å¸‚åœºæ´å¯Ÿåˆ†æå¸ˆæ‹†åˆ†è®¾è®¡

```
åŸ Agent: generate_full_report_stream (å•ä½“)
                    â†“ æ‹†åˆ†ä¸º
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MarketInsightOrchestrator                    â”‚
â”‚  â€¢ æ¥æ”¶ç”¨æˆ·æ¡£æ¡ˆï¼Œåˆ†è§£ä¸º 4 ä¸ªå¹¶è¡Œå­ä»»åŠ¡                          â”‚
â”‚  â€¢ åè°ƒå¤šè½®è¾©è®ºï¼Œå¤„ç†è´¨ç–‘ä¸å›åº”                                 â”‚
â”‚  â€¢ èšåˆå­ Agent ç»“æœï¼Œç”Ÿæˆæœ€ç»ˆå…±è¯†æŠ¥å‘Š                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â–¼               â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ TrendScout  â”‚  â”‚ Competitor  â”‚  â”‚ Regulation  â”‚  â”‚   Social    â”‚
    â”‚             â”‚  â”‚  Analyst    â”‚  â”‚  Checker    â”‚  â”‚  Sentinel   â”‚
    â”‚ â€¢ å®è§‚è¶‹åŠ¿  â”‚  â”‚ â€¢ ç«å“çŸ©é˜µ  â”‚  â”‚ â€¢ æ³•è§„æ¸…å•  â”‚  â”‚ â€¢ Reddit    â”‚
    â”‚ â€¢ å¸‚åœºè§„æ¨¡  â”‚  â”‚ â€¢ å®šä»·åˆ†æ  â”‚  â”‚ â€¢ å…³ç¨ç¨ç‡  â”‚  â”‚ â€¢ Twitter*  â”‚
    â”‚ â€¢ æ¶ˆè´¹ä¹ æƒ¯  â”‚  â”‚ â€¢ SWOTåˆ†æ  â”‚  â”‚ â€¢ è®¤è¯è¦æ±‚  â”‚  â”‚ â€¢ èˆ†æƒ…åˆ†æ  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                 â”‚                 â”‚                 â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                          DebateCoordinator
                          (å¤šè½®è¾©è®ºåè°ƒ)
                                   â”‚
                                   â–¼
                          Supabase Entities
                          (å¸‚åœº/ç«å“/æ³•è§„/èˆ†æƒ…å®ä½“)
```

---

## ä¸‰ã€æŠ€æœ¯é€‰å‹

### 3.1 ç¡®å®šçš„æŠ€æœ¯æ ˆ

| é¢†åŸŸ | é€‰æ‹© | ç†ç”± |
|-----|------|-----|
| **Agent æ¡†æ¶** | **æ¥å£ä¸åè®®åŸç”Ÿå®ç° + å›¾/çŠ¶æ€æœºç¼–æ’å†…æ ¸ï¼ˆä¼˜å…ˆ LangGraphï¼Œä¿ç•™å¯æ›¿æ¢å±‚ï¼‰** | ä¿æŒè‡ªä¸»å¯æ§ï¼ŒåŒæ—¶è·å¾—å¹¶å‘ã€é‡è¯•ã€checkpointã€å¯å›æ”¾ç­‰å·¥ä½œæµèƒ½åŠ› |
| **ç¼–æ’æ¥å£** | `IGraphEngine` æŠ½è±¡æ¥å£ | å¯æ›¿æ¢å®ç°ï¼ˆLangGraph â†’ è‡ªç ” â†’ å…¶ä»–ï¼‰ |
| **è®°å¿†å­˜å‚¨** | Supabase | äº‘åŸç”Ÿï¼Œè‡ªå¸¦ Auth/Storage/Realtime |
| **API è®¾è®¡** | å…¨æ–° v2 API | æ–°çš„è¯·æ±‚/å“åº” schemaï¼Œä¸å…¼å®¹æ—§ç‰ˆ |
| **çŠ¶æ€ç®¡ç†** | Context + Reducer | é›†ä¸­ç®¡ç†å¤æ‚çŠ¶æ€ |
| **å¯è§‚æµ‹æ€§** | Langsmith / Phoenix (åç»­) | Agent è°ƒè¯•ä¸ç›‘æ§ |

### 3.2 æŠ€æœ¯å†³ç­–è®°å½•

| é—®é¢˜ | å†³ç­– | ç†ç”± |
|-----|------|-----|
| **LangGraph é›†æˆæ·±åº¦** | æŠ½è±¡æ¥å£ + å¯æ’æ‹”å®ç° | å®šä¹‰ `IGraphEngine` æ¥å£ï¼ŒPhase 1-2 ç”¨ LangGraph ä½œä¸ºå”¯ä¸€å®ç°ï¼Œæœªæ¥å¯æ›¿æ¢ |
| **Checkpoint å­˜å‚¨** | Phase 2 ç”¨ LangGraph åŸç”Ÿ Saver â†’ Phase 3 è¿ç§»è‡ªå®šä¹‰ | é¿å… Phase 2 å¼€å‘é˜»å¡ |
| **tool_invocations å†™å…¥** | å¼‚æ­¥å†™å…¥ + è„±æ• + å¤±è´¥ä¸é˜»å¡ | å·¥å…·è°ƒç”¨ä¸é˜»å¡ä¸»æµç¨‹ï¼Œæ•æ„Ÿæ•°æ®è‡ªåŠ¨è„±æ• |
| **å‰ç«¯ SSE è§£æ** | å…ˆç”¨ switch-caseï¼ŒæŒ‰éœ€å¼•å…¥ XState | 12 ç§äº‹ä»¶ç”¨ switch å¯æ§ï¼Œå¤æ‚ä¾èµ–å†å¼•å…¥çŠ¶æ€æœº |

**æ¨¡å‹å…¼å®¹æ€§å¤‡æ³¨ï¼ˆç«å±±æ–¹èˆŸ Web Searchï¼‰**

- å½“å‰é¡¹ç›®çš„å¸‚åœºæ´å¯Ÿé“¾è·¯ä¾èµ– Responses API çš„å·¥å…·è°ƒç”¨èƒ½åŠ›ï¼ˆ`web_search`ï¼‰ï¼Œå› æ­¤éœ€è¦é€‰æ‹©â€œè”ç½‘æœç´¢å·¥å…·â€æ”¯æŒåˆ—è¡¨ä¸­çš„æ¨¡å‹ã€‚
- å…¼å®¹ `web_search` çš„ model_idï¼ˆä»¥å®˜æ–¹æ¨¡å‹åˆ—è¡¨çš„â€œè”ç½‘æœç´¢å·¥å…·â€ç« èŠ‚ä¸ºå‡†ï¼‰ï¼š`doubao-seed-2-0-pro-260215`ã€`doubao-seed-1-6-250615`ã€`deepseek-v3-2-251201`ã€`deepseek-v3-1-terminus`ã€`deepseek-v3-1-250821`ã€`kimi-k2-thinking-251104`ã€`kimi-k2-250905`ã€‚
- æ¨èç­–ç•¥ï¼šä¸»åŠ›ä¼˜å…ˆé€‰æ‹© `doubao-seed-2-0-pro-260215`ï¼›å…¼å®¹ä¿åº•ä½¿ç”¨ `doubao-seed-1-6-250615`ï¼ˆå½“å‰é¡¹ç›®é»˜è®¤ï¼‰ï¼›DeepSeek/Kimi ä½œä¸ºå¤‡é€‰éœ€é¢å¤–å…³æ³¨å…¶ RPM/TPM é…é¢ä¸æ•´ä½“ååã€‚
- è‹¥é€‰æ‹©ä¸åœ¨è¯¥æ”¯æŒåˆ—è¡¨ä¸­çš„æ¨¡å‹ï¼šéœ€å…³é—­ `use_websearch` æˆ–æ”¹ä¸º"å¤–éƒ¨æœç´¢ â†’ å†å–‚ç»™æ¨¡å‹"çš„å·¥å…·é“¾ï¼Œå¦åˆ™ä¼šå‡ºç°å·¥å…·ä¸å¯ç”¨æˆ–è°ƒç”¨å¤±è´¥ã€‚

### 3.3 ç«å±±å¼•æ“ Ark API è°ƒç”¨è§„èŒƒ

> æ‰€æœ‰ Agent é€šè¿‡ **Responses API** ç»Ÿä¸€è°ƒç”¨æ¨¡å‹

#### 3.3.1 åŸºæœ¬è°ƒç”¨æ ¼å¼

```python
from volcenginesdkark import Ark

client = Ark(api_key=settings.ark_api_key)

response = client.responses.create(
    model="<model_id>",  # ä¾‹å¦‚ doubao-seed-2-0-pro-260215
    input=[
        {
            "role": "user",
            "content": [
                {"type": "input_text", "text": "ä½ çš„æç¤ºè¯..."}
            ]
        }
    ],
    tools=[
        {"type": "web_search", "limit": 15}  # å¯é€‰ï¼šè”ç½‘æœç´¢
    ],
    stream=True,
    extra_body={
        "thinking": {"type": "auto"}  # Thinking æ¨¡å¼æ§åˆ¶
    }
)
```

#### 3.3.2 Thinking æ¨¡å¼é…ç½®

| é…ç½®å€¼ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|-------|------|---------|
| `{"type": "auto"}` | æ¨¡å‹è‡ªåŠ¨åˆ¤æ–­æ˜¯å¦éœ€è¦æ·±åº¦æ€è€ƒ | é»˜è®¤æ¨è |
| `{"type": "enabled"}` | å¼ºåˆ¶å¯ç”¨ Thinking æ¨¡å¼ | å¤æ‚æ¨ç†ä»»åŠ¡ (RegulationChecker, Synthesizer) |
| `{"type": "disabled"}` | ç¦ç”¨ Thinking æ¨¡å¼ | ç®€å•å¿«é€Ÿå“åº”åœºæ™¯ |

#### 3.3.3 æµå¼å“åº” Chunk ç±»å‹

| chunk.type | è¯´æ˜ | å¤„ç†æ–¹å¼ |
|-----------|------|---------|
| `response.reasoning_summary_text.delta` | æ€è€ƒè¿‡ç¨‹ (Thinking è¾“å‡º) | è½¬å‘ä¸º `agent_thinking` SSE äº‹ä»¶ |
| `response.output_text.delta` | æœ€ç»ˆè¾“å‡ºå†…å®¹ | è½¬å‘ä¸º `agent_output` SSE äº‹ä»¶ |
| `response.web_search_call.in_progress` | æœç´¢å¼€å§‹ | è½¬å‘ä¸º `tool_start` SSE äº‹ä»¶ |
| `response.web_search_call.completed` | æœç´¢å®Œæˆ | è½¬å‘ä¸º `tool_end` SSE äº‹ä»¶ |
| `response.completed` | å“åº”å®Œæˆ | è½¬å‘ä¸º `agent_end` SSE äº‹ä»¶ |

#### 3.3.4 Agent ä¸“å±é…ç½®ç¤ºä¾‹

```python
# Agent-Model æ˜ å°„é…ç½® (å¯¹åº” backend/core/config.py)
AGENT_MODEL_CONFIG = {
    "trend_scout": {
        "model": "doubao-seed-2-0-pro-260215",
        "use_websearch": True,
        "thinking_mode": "auto",
    },
    "competitor_analyst": {
        "model": "deepseek-v3-2-251201",
        "use_websearch": True,
        "thinking_mode": "auto",
    },
    "regulation_checker": {
        "model": "kimi-k2-thinking-251104",
        "use_websearch": True,
        "thinking_mode": "enabled",  # å¼ºåˆ¶å¯ç”¨æ·±åº¦æ¨ç†
    },
    "social_sentinel": {
        "model": "doubao-seed-2-0-pro-260215",
        "use_websearch": True,
        "thinking_mode": "auto",
    },
    "synthesizer": {
        "model": "kimi-k2-thinking-251104",
        "use_websearch": False,  # ç»¼åˆé˜¶æ®µä¸éœ€è¦æœç´¢
        "thinking_mode": "enabled",
    },
    "debate_challenger": {
        "model": "deepseek-v3-2-251201",
        "use_websearch": False,  # è¾©è®ºé˜¶æ®µä¸éœ€è¦æœç´¢
        "thinking_mode": "auto",
    },
}

# è¾©è®ºé…å¯¹é…ç½®
DEBATE_PAIRS = [
    ("trend_scout", "competitor_analyst"),      # è¶‹åŠ¿ vs ç«äº‰
    ("regulation_checker", "social_sentinel"),  # æ³•è§„ vs èˆ†æƒ…
]
```

### 3.4 ç¼–æ’å†…æ ¸å·¥ç¨‹çº¦æŸ

> å¤š Agent åä½œçš„éš¾ç‚¹åœ¨"å·¥ä½œæµç¼–æ’"ï¼Œä¸æ˜¯"å†™å¾ˆå¤š Agent"ã€‚ä»¥ä¸‹çº¦æŸåœ¨ Phase 1/2 å¿…é¡»æ»¡è¶³ï¼š

- **å›¾/çŠ¶æ€æœºè¡¨è¾¾**ï¼šæ˜ç¡® Nodeã€Edgeã€Stateï¼›æ”¯æŒ `fan-out -> fan-in` å¹¶è¡Œæ”¶æ•›ã€‚
- **è¾©è®ºå¾ªç¯æ”¯æŒ**ï¼šæ”¯æŒå¤šè½®è¿­ä»£ï¼ˆRound 1-4ï¼‰ï¼Œå¯é…ç½®è½®æ•°ä¸ç»ˆæ­¢æ¡ä»¶ã€‚
- **checkpoint + æ–­ç‚¹ç»­è·‘**ï¼šä»¥ `session_id + run_id + node_id` ä¸ºæœ€å°å•ä½æŒä¹…åŒ–çŠ¶æ€ã€‚
- **å¹‚ç­‰ä¸å®¡è®¡**ï¼šæ‰€æœ‰å¯¹å¤–å·¥å…·è°ƒç”¨å¿…é¡»é€šè¿‡ ToolRegistryï¼Œè®°å½•è¾“å…¥/è¾“å‡º/é”™è¯¯/è€—æ—¶/æˆæœ¬ã€‚
- **å¤±è´¥ç­–ç•¥**ï¼šèŠ‚ç‚¹çº§é‡è¯•ï¼ˆé€€é¿ï¼‰ã€é™çº§ï¼ˆskip/partialï¼‰ã€ç†”æ–­ï¼ˆcircuit breakerï¼‰ã€‚
- **ç»“æœå¥‘çº¦åŒ–**ï¼šAgent/Tool/Orchestrator çš„äº§å‡ºç”¨å¯è§£æ schemaï¼ˆJSONB + Pydanticï¼‰ã€‚

### 3.5 åç«¯æ–°ç›®å½•ç»“æ„

```
backend/
â”œâ”€â”€ main.py                         # FastAPI å…¥å£ï¼ˆä»… v2ï¼‰
â”œâ”€â”€ requirements.txt                # WeaveAI 2.0 ä¾èµ–ï¼ˆå« psycopg2-binaryï¼‰
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ config.py                   # Settings + Agent-Model æ˜ å°„
â”‚   â”œâ”€â”€ ark_client.py               # Ark Responses API å°è£…ï¼ˆSSE/Thinking/WebSearchï¼‰
â”‚   â”œâ”€â”€ graph_engine.py             # LangGraph Orchestrator + IGraphEngine
â”‚   â””â”€â”€ exceptions.py               # è‡ªå®šä¹‰å¼‚å¸¸
â”œâ”€â”€ agents/
â”‚   â”œâ”€â”€ base.py                     # BaseAgent / AgentContext
â”‚   â”œâ”€â”€ factory.py                  # Agent å·¥å‚
â”‚   â”œâ”€â”€ market/                     # 4 ä¸ª Worker + Synthesizer
â”‚   â””â”€â”€ debate/                     # Challengerï¼ˆçº¢é˜Ÿï¼‰
â”œâ”€â”€ routers/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ v2/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ market_insight.py       # /stream /generate /status /health
â”œâ”€â”€ schemas/
â”‚   â””â”€â”€ v2/
â”‚       â”œâ”€â”€ requests.py             # MarketInsightRequest / UserProfile
â”‚       â”œâ”€â”€ responses.py            # MarketInsightResponse / WorkflowStatus
â”‚       â””â”€â”€ events.py               # SSE äº‹ä»¶åè®®ï¼ˆæšä¸¾ + åŸºç¡€ç»“æ„ï¼‰
â””â”€â”€ database/
    â”œâ”€â”€ pg_client.py                # Phase 1: Postgres ç›´è¿ï¼ˆpsycopg2ï¼‰
    â”œâ”€â”€ event_sink.py               # Phase 1: SSE äº‹ä»¶è½åº“æ±‡èšå™¨ï¼ˆå¼‚æ­¥é˜Ÿåˆ—ï¼‰
    â”œâ”€â”€ client.py                   # ï¼ˆå¯é€‰ï¼‰supabase-py å®¢æˆ·ç«¯å°è£…ï¼ˆåç»­é˜¶æ®µå¯ç”¨ï¼‰
    â””â”€â”€ migrations/
        â”œâ”€â”€ 001_initial_schema.sql
        â”œâ”€â”€ 002_align_v2_schema.sql
        â””â”€â”€ 003_update_views_and_functions.sql
```

---

## å››ã€åˆ†é˜¶æ®µè¿­ä»£è®¡åˆ’

### Phase 1: åŸºç¡€æ¶æ„é‡æ„ (2 å‘¨)

**ç›®æ ‡**: æ‹†åˆ†å•ä½“ã€å»ºç«‹æ¨¡å—åŒ–åŸºç¡€ã€å®šä¹‰åè®®

| ä»»åŠ¡ ID | ä»»åŠ¡æè¿° | ä¼˜å…ˆçº§ | é¢„è®¡å·¥æ—¶ |
|--------|---------|-------|---------| 
| P1-1 | åç«¯æ¨¡å—åŒ–æ‹†åˆ†ï¼ˆcore/agents/routers/schemas ç»“æ„å›ºåŒ–ï¼‰| é«˜ | 3 å¤© |
| P1-2 | BaseAgent æŠ½è±¡ç±»è®¾è®¡ä¸å®ç° | é«˜ | 2 å¤© |
| P1-3 | å‰ç«¯ Context + Reducer çŠ¶æ€ç®¡ç†é‡æ„ï¼ˆåˆ é™¤ validation ç›¸å…³çŠ¶æ€ï¼‰| é«˜ | 2 å¤© |
| P1-4 | æœ¬åœ° Supabase/Postgresï¼ˆdocker-composeï¼‰æ•°æ®æ¨¡å‹ + migrationsï¼ˆ001-003ï¼‰| é«˜ | 1 å¤© |
| P1-5 | Phase 1 æ•°æ®åº“å®¢æˆ·ç«¯å°è£…ï¼ˆpsycopg2 ç›´è¿ + æŸ¥è¯¢æ¥å£ï¼‰| é«˜ | 1 å¤© |
| P1-6 | å®šä¹‰ IGraphEngine æ¥å£ + äº‹ä»¶åè®® + è¡¨ç»“æ„ + æœ€å°å†™å…¥ï¼ˆä¸å«æˆæœ¬ç»Ÿè®¡/é‡æ”¾å·¥å…·é“¾ï¼‰| é«˜ | 1.5 å¤© |

> **P1-6 èŒƒå›´æ§åˆ¶è¯´æ˜**ï¼š
> - âœ… Phase 1 åšï¼šäº‹ä»¶åè®®å®šä¹‰ï¼ˆSSE äº‹ä»¶ç±»å‹ï¼‰ã€è¡¨ç»“æ„è®¾è®¡ï¼ˆtool_invocationsï¼‰ã€æœ€å°å†™å…¥ï¼ˆfire-and-forgetï¼‰ã€IGraphEngine æ¥å£å®šä¹‰
> - âŒ Phase 4 åšï¼šæˆæœ¬ç»Ÿè®¡ï¼ˆtokens/è´¹ç”¨è®¡ç®—ï¼‰ã€é‡æ”¾å·¥å…·é“¾ï¼ˆæ ¹æ®æµæ°´é‡è·‘ï¼‰ã€å®Œæ•´å®¡è®¡ UI

**äº¤ä»˜ç‰©**:
- æ¨¡å—åŒ–çš„åç«¯ä»£ç ç»“æ„
- BaseAgent æŠ½è±¡ç±»åŠæ–‡æ¡£
- å‰ç«¯ WeaveContext çŠ¶æ€ç®¡ç†
- Supabase é¡¹ç›®åŠæ•°æ®è¡¨
- IGraphEngine æ¥å£å®šä¹‰
- v2 æµå¼åè®®ï¼ˆå«è¾©è®ºäº‹ä»¶ï¼‰

#### Phase 1 å½“å‰è¿›åº¦ï¼ˆ2026-02-10ï¼‰

- âœ… P1-1ï¼šåç«¯æ¨¡å—åŒ–æ‹†åˆ†å·²å®Œæˆï¼ˆä»…ä¿ç•™ v2 ä»£ç è·¯å¾„ï¼‰
- âœ… P1-2ï¼šBaseAgent å·²å®Œæˆï¼ˆ`backend/agents/base.py`ï¼‰
- âœ… P1-3ï¼šå‰ç«¯ Context + Reducer å·²å®Œæˆï¼Œä¸”å·²ç§»é™¤ validation/action ç­‰æ—§æ¨¡å—
- âœ… P1-4ï¼šæœ¬åœ° Supabase/Postgres å·²è½åœ°å¹¶å®Œæˆå¢é‡è¿ç§»ï¼ˆ`backend/database/migrations/002_align_v2_schema.sql`ã€`backend/database/migrations/003_update_views_and_functions.sql`ï¼‰
- âœ… P1-5ï¼šPhase 1 é‡‡ç”¨ Postgres ç›´è¿ï¼ˆ`backend/database/pg_client.py`ï¼‰
- âœ… P1-6ï¼šæœ€å°å†™å…¥é—­ç¯å·²å®Œæˆï¼šSSE å…³é”®äº‹ä»¶é€šè¿‡ fire-and-forget é˜Ÿåˆ—è½åº“ï¼ˆ`backend/database/event_sink.py`ï¼‰

éªŒæ”¶å¤ç°è§ï¼š`PHASE1_ACCEPTANCE.md`ï¼ˆåŒ…å«è¿ç§»æ‰§è¡Œå‘½ä»¤ã€SSE è§¦å‘å‘½ä»¤ã€SQL æ ¡éªŒï¼‰ã€‚

### Phase 2: å¤š Agent åä½œæ¡†æ¶ (2.5 å‘¨)

**ç›®æ ‡**: å®ç° Supervisor-Worker + Debate åä½œæ¨¡å¼

| ä»»åŠ¡ ID | ä»»åŠ¡æè¿° | ä¼˜å…ˆçº§ | é¢„è®¡å·¥æ—¶ |
|--------|---------|-------|---------| 
| P2-1 | Orchestrator Agent å®ç°ï¼ˆLangGraph å†…æ ¸ï¼šä»»åŠ¡åˆ†è§£/è·¯ç”±/å¹¶è¡Œ/èšåˆ/é‡è¯•/checkpointï¼‰| é«˜ | 3 å¤© |
| P2-2 | å®ç° MarketInsightOrchestratorï¼ˆå¸‚åœºæ´å¯Ÿç¼–æ’å™¨ï¼‰| é«˜ | 2 å¤© |
| P2-3 | å®ç° TrendScout Agentï¼ˆè¶‹åŠ¿ç ”ç©¶å‘˜ï¼‰| é«˜ | 1.5 å¤© |
| P2-4 | å®ç° CompetitorAnalyst Agentï¼ˆç«å“åˆ†æå¸ˆï¼‰| é«˜ | 1.5 å¤© |
| P2-5 | å®ç° RegulationChecker Agentï¼ˆæ³•è§„æ£€æŸ¥å‘˜ï¼‰| é«˜ | 1.5 å¤© |
| P2-6 | å®ç° SocialSentinel Agentï¼ˆç¤¾äº¤èˆ†æƒ…å‘˜ï¼‰[æ–°å¢] | é«˜ | 2 å¤© |
| P2-7 | å®ç° DebateCoordinatorï¼ˆè¾©è®ºåè°ƒå™¨ï¼‰[æ–°å¢] | é«˜ | 2 å¤© |
| P2-8 | Agent é—´é€šä¿¡åè®®è®¾è®¡ä¸å®ç°ï¼ˆå«è¾©è®ºè¯­ä¹‰ï¼‰| ä¸­ | 1 å¤© |
| P2-9 | Orchestrator é‡è¯•è€—å°½é™çº§ç­–ç•¥ï¼ˆskip/partial/failï¼‰+ `retry` äº‹ä»¶å¯è¿½è¸ªåŒ– | é«˜ | 1 å¤© |
| P2-10 | SSE å¥‘çº¦ä¸€è‡´æ€§ä¸æ–­è¿æ¢å¤ï¼ˆå«åå‘ä»£ç†ç¼“å†²å…¼å®¹ï¼‰ | ä¸­ | 1 å¤© |

> **Phase 2 èŒƒå›´è°ƒæ•´ï¼ˆ2026-02-11ï¼‰**ï¼š
> - `SocialSentinel` çš„ **Reddit API ç›´è¿**ä¸å†ä½œä¸º Phase 2 é˜»å¡éªŒæ”¶é¡¹ã€‚
> - Reddit æ•°æ®æºèƒ½åŠ›ç»Ÿä¸€åç½®åˆ° **Phase 4ï¼ˆP4-3 / P4-4ï¼‰** å®ç°ã€‚
> - Phase 2 ä»…è¦æ±‚ `SocialSentinel` åœ¨ `enable_websearch` åœºæ™¯ä¸‹ç¨³å®šäº§å‡ºç¤¾åª’æ´å¯Ÿã€‚

**äº¤ä»˜ç‰©**:
- Orchestrator Agentï¼ˆåŸºäº LangGraphï¼‰
- Market Intelligence Swarm (4 ä¸ªå­ Agent + è¾©è®ºåè°ƒå™¨)
- Agent é€šä¿¡åè®®æ–‡æ¡£
- å¤šè½®è¾©è®ºæµç¨‹å®ç°
- æœ€å°å¯å›æ”¾æ‰§è¡Œé“¾è·¯

#### Phase 2 æ”¶å£æµ‹è¯•è®°å½•ï¼ˆ2026-02-13ï¼‰

- âœ… è·¯ç”±æµ‹è¯•é€šè¿‡ï¼š`debate_rounds=0/1/2` åˆ†åˆ«éªŒè¯äº†ã€Œç›´è¾¾ç»¼åˆã€ã€Œä»… Round 1ã€ã€ŒRound 1+2ã€è·¯å¾„ï¼Œä¸”å‡å¯è§‚æµ‹åˆ°å¯¹åº”ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚
- âœ… æ–­è¿æ¢å¤é€šè¿‡ï¼šä½¿ç”¨å›ºå®š `session_id` ä¸­é€”æ–­å¼€ SSE åï¼Œ`/api/v2/market-insight/status/{session_id}` èƒ½è¿”å› `session/agent_results/workflow_events`ã€‚
- âœ… è½åº“é“¾è·¯éªŒè¯é€šè¿‡ï¼š`sessions` ä¸ `workflow_events` å¯æŸ¥è¯¢åˆ° `orchestrator_start`ã€`agent_start` ç­‰å…³é”®äº‹ä»¶ã€‚
- âš ï¸ è¿è¡Œæ³¨æ„äº‹é¡¹ï¼š`session_id` å¿…é¡»ä½¿ç”¨çº¯ UUIDï¼ˆä¸å¯åŠ  `acc-` å‰ç¼€ï¼‰ï¼Œå¦åˆ™ä¼šè§¦å‘ `invalid input syntax for type uuid` å¹¶å¯¼è‡´è½åº“å¤±è´¥ã€‚
- âš ï¸ å¤–éƒ¨ä¾èµ–æ³¢åŠ¨ï¼šè¾©è®ºé˜¶æ®µå¶å‘ Ark æµå¼è¿æ¥ä¸­æ–­ï¼ˆ`incomplete chunked read` / `Connection error`ï¼‰ï¼Œå½“å‰ç”±é‡è¯•ä¸é™çº§ç­–ç•¥å…œåº•ï¼Œä¸é˜»å¡ä¸»æµç¨‹éªŒæ”¶ã€‚
- ğŸ“ éªŒæ”¶è®°å½•å‚è€ƒï¼š`PHASE2_ACCEPTANCE.md`ã€‚

### Phase 3: æ¯”èµ›è¯æ®å±‚ä¸è½»é‡è®°å¿† (0.5~1 å‘¨ï¼Œå¼¹æ€§)

**ç›®æ ‡**: åœ¨ä¸å¤§æ”¹æ¶æ„çš„å‰æä¸‹ï¼Œä¼˜å…ˆæ„å»ºâ€œå¯è¯æ˜ã€å¯å¤ç°ã€å¯è®²è¿°â€çš„è¯„å®¡è¯æ®é“¾ã€‚

| ä»»åŠ¡ ID | ä»»åŠ¡æè¿° | ä¼˜å…ˆçº§ | é¢„è®¡å·¥æ—¶ |
|--------|---------|-------|---------| 
| P3-1 | Evidence Packï¼ˆæ¥æºé“¾æ¥ + å…³é”®ç»“è®º + ç½®ä¿¡åº¦ + ç”Ÿæˆæ—¶é—´ï¼‰ç»“æ„åŒ–è¾“å‡º | é«˜ | 1 å¤© |
| P3-2 | è½»é‡è®°å¿†å¿«ç…§ï¼ˆæŒ‰ session ä¿å­˜å®ä½“æ‘˜è¦ä¸ç»“è®ºï¼Œä¸å¼ºä¾èµ–å›¾æ•°æ®åº“ï¼‰| é«˜ | 1 å¤© |
| P3-3 | è¯„æµ‹æ ·æœ¬é›†ï¼ˆ10~20 ç»„ï¼‰+ ä¸€é”®å›æ”¾è„šæœ¬ï¼ˆç”¨äºæ¯”èµ›å‰ç¨³å®šæ€§å¤æ ¸ï¼‰ | é«˜ | 1 å¤© |
| P3-4 | ï¼ˆStretchï¼‰Supabase Realtime / è‡ªå®šä¹‰ CheckpointSaver æ·±åŒ–æ¥å…¥ | ä¸­ | 1~2 å¤© |

**äº¤ä»˜ç‰©**:
- Evidence Pack è¾“å‡ºè§„èŒƒï¼ˆå¯ç›´æ¥æ”¾è¿›è·¯æ¼”ææ–™ï¼‰
- è½»é‡è®°å¿†å¿«ç…§è½åº“ä¸æŸ¥è¯¢èƒ½åŠ›
- å¯å¤ç°å®éªŒæ ·æœ¬é›†ä¸å›æ”¾è„šæœ¬
- ï¼ˆStretchï¼‰Realtime/Checkpoint æ·±åŒ–èƒ½åŠ›

### Phase 4: å·¥å…·å±‚æ”¶æ•›ä¸æˆæœ¬éŸ§æ€§ (0.5~1 å‘¨ï¼Œå¼¹æ€§)

**ç›®æ ‡**: ä»¥â€œæ¯”èµ›ç°åœºç¨³å®šæ¼”ç¤º + å•æ¬¡åˆ†ææˆæœ¬å¯è§£é‡Šâ€ä¸ºç¬¬ä¸€ä¼˜å…ˆï¼Œæ”¶æ•›å·¥å…·é“¾å¤æ‚åº¦ã€‚

| ä»»åŠ¡ ID | ä»»åŠ¡æè¿° | ä¼˜å…ˆçº§ | é¢„è®¡å·¥æ—¶ |
|--------|---------|-------|---------| 
| P4-1 | ToolRegistry Liteï¼šç»Ÿä¸€æ¥ç®¡ç°æœ‰ `web_search` è·¯å¾„ï¼ˆä¿ç•™å¯æ‰©å±•æ¥å£ï¼‰| é«˜ | 1 å¤© |
| P4-2 | æˆæœ¬/æ—¶å»¶/é”™è¯¯ç‡åŸ‹ç‚¹ï¼ˆæŒ‰ session ä¸ agent ç»Ÿè®¡ï¼‰| é«˜ | 1 å¤© |
| P4-3 | æˆæœ¬æŠ¤æ ä¸é™çº§ç­–ç•¥è”åŠ¨ï¼ˆè¶…æ—¶/å¤±è´¥è‡ªåŠ¨é™çº§ï¼Œç¡®ä¿æ¼”ç¤ºä¸ä¸­æ–­ï¼‰| é«˜ | 0.5 å¤© |
| P4-4 | çƒ­ç‚¹æŸ¥è¯¢ç¼“å­˜ä¸ Prompt æ¨¡æ¿å›ºåŒ–ï¼ˆå‡å°‘æŠ–åŠ¨ï¼Œæå‡å¤ç°æ€§ï¼‰| ä¸­ | 0.5 å¤© |
| P4-5 | ï¼ˆStretchï¼‰`reddit_api` é€‚é…å™¨ï¼ˆFeature Flag æ§åˆ¶ï¼Œå¤±è´¥è‡ªåŠ¨å›é€€ `web_search`ï¼‰| ä¸­ | 1 å¤© |

**äº¤ä»˜ç‰©**:
- ToolRegistry Liteï¼ˆæœ€å°å¯ç”¨ + å¯æ‰©å±•ï¼‰
- æˆæœ¬ä¸ç¨³å®šæ€§ç»Ÿè®¡æŠ¥è¡¨ï¼ˆå¯ç”¨äºç­”è¾©ï¼‰
- å¤±è´¥é™çº§ä¸ç¼“å­˜ç­–ç•¥è¯´æ˜
- ï¼ˆStretchï¼‰Reddit é€‚é…å™¨ä¸å¼€å…³ç­–ç•¥

### Phase 5: å‚èµ›æ¼”ç¤ºåŒ…è£…ä¸è·¯æ¼”èµ„äº§ (1~1.5 å‘¨)

**ç›®æ ‡**: æŠŠâ€œå·¥ç¨‹å¯ç”¨â€å‡çº§ä¸ºâ€œè¯„å§” 3~5 åˆ†é’Ÿå¯æ„ŸçŸ¥ä»·å€¼â€çš„æ¼”ç¤ºä¸è·¯æ¼”èµ„äº§ã€‚

| ä»»åŠ¡ ID | ä»»åŠ¡æè¿° | ä¼˜å…ˆçº§ | é¢„è®¡å·¥æ—¶ |
|--------|---------|-------|---------| 
| P5-1 | è¯„å§”æ¨¡å¼ï¼ˆé¢„ç½® 60 ç§’æé€Ÿ / 3 åˆ†é’Ÿæ ‡å‡† / æ·±åº¦æ¼”ç¤ºä¸‰å¥—åœºæ™¯ï¼‰| é«˜ | 1 å¤© |
| P5-2 | å…³é”®æŒ‡æ ‡çœ‹æ¿ï¼ˆè€—æ—¶ã€ç¨³å®šæ€§ã€è¯æ®è¦†ç›–ç‡ã€é™çº§æ¬¡æ•°ï¼‰| é«˜ | 1 å¤© |
| P5-3 | ä¸€é”®å¯¼å‡ºè·¯æ¼”åŒ…ï¼ˆHTML æŠ¥å‘Š + æ‰§è¡Œæ‘˜è¦ + å…³é”®è¯æ®ï¼‰| é«˜ | 0.5 å¤© |
| P5-4 | æ¼”ç¤ºä¿æŠ¤æ¨¡å¼ï¼ˆå¼±ç½‘/æ–­æµæ—¶è‡ªåŠ¨å›è¡¥ statusï¼Œä¿è¯ç°åœºè¿ç»­æ€§ï¼‰| é«˜ | 0.5 å¤© |
| P5-5 | è·¯æ¼”èµ„äº§æ–‡æ¡£ï¼ˆDemo Scriptã€FAQã€ç«å“å·®å¼‚ä¸€é¡µçº¸ã€é£é™©åº”ç­”ï¼‰| ä¸­ | 1 å¤© |
| P5-6 | æŠ¥å‘Šå¯è§†åŒ–å¢å¼ºï¼ˆVega-Liteï¼‰ï¼šåœ¨ä¸å‹ç¼©æ­£æ–‡å®Œæ•´æ€§çš„å‰æä¸‹ï¼Œä¸ºå…³é”®ç»“è®ºè¡¥å……å›¾è¡¨ï¼ˆå‰ç«¯å®æ—¶é¡µ + å¯¼å‡º HTML åŒç«¯æ¸²æŸ“ï¼Œå¤±è´¥è‡ªåŠ¨å›é€€æ–‡æœ¬ï¼‰| é«˜ | 1 å¤© |

**äº¤ä»˜ç‰©**:
- è¯„å§”æ¨¡å¼æ¼”ç¤ºå…¥å£ä¸ä¸‰å¥—é¢„ç½®åœºæ™¯
- å¯è§†åŒ–æŒ‡æ ‡çœ‹æ¿ä¸ç¨³å®šæ€§è¯æ®
- ä¸€é”®å¯¼å‡ºè·¯æ¼”åŒ…
- Demo Script + FAQ + å·®å¼‚åŒ–è¯´æ˜æ–‡æ¡£
- å›¾è¡¨å¢å¼ºç‰ˆç»¼åˆæŠ¥å‘Šï¼ˆå®Œæ•´æ­£æ–‡ + å…³é”®å›¾è¡¨ + æ¸²æŸ“å¤±è´¥å›é€€ï¼‰

---

## äº”ã€æ•°æ®æ¨¡å‹è®¾è®¡

### 5.1 æ•°æ®è¡¨ï¼ˆå½“å‰å®ç°ï¼ŒPhase 1ï¼‰

Phase 1 çš„æ•°æ®åº“ schema ä»¥è¿ç§»æ–‡ä»¶ä¸ºå‡†ï¼š

- `backend/database/migrations/001_initial_schema.sql`
- `backend/database/migrations/002_align_v2_schema.sql`
- `backend/database/migrations/003_update_views_and_functions.sql`

å½“å‰å®ç°å·²ä½¿ç”¨/å†™å…¥çš„æ ¸å¿ƒè¡¨ï¼ˆpublic schemaï¼‰ï¼š

- `sessions`ï¼šä¼šè¯ä¸å·¥ä½œæµçŠ¶æ€ï¼ˆåŒ…å« `profile jsonb` + v2 ç”»åƒåˆ— + status/phase/timestampsï¼‰
- `agent_results`ï¼šæ¯ä¸ª Agent ä¸€è¡Œï¼ˆ`unique(session_id, agent_name)`ï¼‰ï¼Œä¿å­˜ content/thinking/sources/duration/status/error
- `debate_exchanges`ï¼šè¾©è®ºäº¤æ¢ï¼ˆå« `round_number/debate_type/followup_content/revised`ï¼‰
- `workflow_events`ï¼šå…³é”®ç”Ÿå‘½å‘¨æœŸäº‹ä»¶æµæ°´ï¼ˆPhase 1 ä¸å†™ chunk äº‹ä»¶ï¼Œé¿å…é«˜é¢‘å†™å…¥ï¼‰
- `feedback`ï¼šç”¨æˆ·åé¦ˆï¼ˆé¢„ç•™ï¼‰
- `tool_invocations`ï¼šPhase 1 å·²å»ºè¡¨ï¼›Phase 4 æ‰©å±•å®¡è®¡/è„±æ•/æˆæœ¬ç»Ÿè®¡ä¸ ToolRegistry è”åŠ¨

RLS ç­–ç•¥ï¼šå½“å‰å¼€å‘é˜¶æ®µé‡‡ç”¨ `Allow all for development`ï¼ˆä¾¿äºéªŒæ”¶ä¸è°ƒè¯•ï¼‰ï¼›åç»­ Phase 3/4 å†æ”¶ç´§ã€‚

### 5.2 å®ä½“ç±»å‹å®šä¹‰

| å®ä½“ç±»å‹ | å±æ€§ç¤ºä¾‹ | å…³ç³»ç±»å‹ |
|---------|---------|---------| 
| `market` | name, region, size, growth_rate | targets, influences |
| `competitor` | name, pricing, strengths, weaknesses | competes_with |
| `product` | sku, category, price, features | belongs_to |
| `trend` | name, description, impact, timeframe | affects |
| `regulation` | name, type, requirements, deadline | applies_to |
| `sentiment` | platform, topic, polarity, volume | relates_to |

---

## å…­ã€API è®¾è®¡

### 6.1 v2 API ç«¯ç‚¹

```
åŸºç¡€è·¯å¾„: /api/v2

# Market Insight v2
POST   /market-insight/stream                # SSE æµå¼è¾“å‡ºï¼ˆæ¨èï¼‰
POST   /market-insight/generate              # åŒæ­¥ç”Ÿæˆï¼ˆä¸€æ¬¡æ€§è¿”å›ï¼‰
GET    /market-insight/status/{session_id}   # æŸ¥è¯¢ä¼šè¯çŠ¶æ€ï¼ˆPhase 1ï¼šä» DB è¯»å–ï¼‰
GET    /market-insight/health                # å¥åº·æ£€æŸ¥
```

### 6.2 è¯·æ±‚/å“åº”ç¤ºä¾‹

**åŒæ­¥ç”Ÿæˆï¼ˆæ¨èç”¨äºç¨³å®šæ€§éªŒè¯ï¼‰**

```json
// POST /api/v2/market-insight/generate
{
  "profile": {
    "target_market": "Germany",
    "supply_chain": "Consumer Electronics",
    "seller_type": "brand",
    "min_price": 30,
    "max_price": 90
  },
  "debate_rounds": 0,
  "enable_followup": false,
  "enable_websearch": false
}
```

**SSE æµå¼è¾“å‡ºï¼ˆæ¨èç”¨äºå‰ç«¯ä½“éªŒéªŒè¯ï¼‰**

```text
// POST /api/v2/market-insight/stream
event: orchestrator_start
data: {"event":"orchestrator_start","timestamp":"..."}

event: agent_start
data: {"event":"agent_start","agent":"trend_scout","timestamp":"..."}

...

event: orchestrator_end
data: {"event":"orchestrator_end","session_id":"<uuid>","final_report":"...","timestamp":"..."}
```

> æç¤ºï¼šSwagger UI ä¸é€‚åˆéªŒè¯ SSEï¼ˆé•¿å“åº”ä¼šå¯¼è‡´æ¸²æŸ“å¼‚å¸¸æˆ–ä¸­æ–­ï¼‰ã€‚Windows ä¸Šè‹¥ä½¿ç”¨ conda è‡ªå¸¦ curlï¼Œå¯èƒ½å‡ºç°è¯·æ±‚ä½“åŒå¼•å·è¢«å‰¥ç¦»å¯¼è‡´ 422ã€‚
> æ¨èä½¿ç”¨ç³»ç»Ÿ curlï¼š`C:\\Windows\\System32\\curl.exe` å¹¶ç”¨ stdin å–‚ JSONï¼ˆè§ `PHASE1_ACCEPTANCE.md`ï¼‰ã€‚

### 6.3 æµå¼åè®®äº‹ä»¶ç±»å‹

| äº‹ä»¶ç±»å‹ | è¯´æ˜ | è½½è· |
|---------|------|-----|
| `orchestrator_start` | ç¼–æ’å™¨å¼€å§‹ | timestamp |
| `orchestrator_end` | ç¼–æ’å™¨ç»“æŸ | final_report |
| `agent_start` | Agent å¼€å§‹æ‰§è¡Œ | agent, task |
| `agent_thinking` | Agent æ€è€ƒè¿‡ç¨‹ | agent, content |
| `agent_output` | Agent è¾“å‡ºå†…å®¹ | agent, content |
| `agent_end` | Agent æ‰§è¡Œç»“æŸ | agent, status, duration |
| `agent_error` | Agent æ‰§è¡Œé”™è¯¯ | agent, error, retry |
| `tool_start` | å·¥å…·å¼€å§‹æ‰§è¡Œ | tool, agent, input |
| `tool_end` | å·¥å…·æ‰§è¡Œç»“æŸ | tool, agent, output, duration |
| `tool_error` | å·¥å…·æ‰§è¡Œé”™è¯¯ | tool, agent, error, retry |
| `checkpoint` | å·¥ä½œæµä¿å­˜æ–­ç‚¹ | node_id, state_ref |
| `retry` | èŠ‚ç‚¹/å·¥å…·é‡è¯• | target_type, target_id, attempt |
| `debate_round_start` | è¾©è®ºè½®æ¬¡å¼€å§‹ [æ–°å¢] | round_number, type, participants |
| `agent_challenge` | Agent æå‡ºè´¨ç–‘ [æ–°å¢] | from_agent, to_agent, challenge_content |
| `agent_respond` | Agent å›åº”è´¨ç–‘ [æ–°å¢] | agent, response_content, revised |
| `consensus_reached` | è¾¾æˆå…±è¯† [æ–°å¢] | consensus_summary, dissent_points, confidence |
| `memory_update` | è®°å¿†æ›´æ–° | entity_type, entity_id |
| `handoff` | Agent äº¤æ¥ | from, to, context |

---

## ä¸ƒã€é£é™©ä¸ç¼“è§£æªæ–½

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|-----|------|-----|---------| 
| **è¾©è®ºæ­»å¾ªç¯** | Agent åå¤è´¨ç–‘æ— æ³•æ”¶æ•› | ä¸­ | é™åˆ¶æœ€å¤§è¾©è®ºè½®æ•°ï¼ˆé»˜è®¤ 2-3 è½®ï¼‰ï¼Œè®¾ç½®è¶…æ—¶ |
| **ç«å±±å¼•æ“ API é™æµ** | å¤š Agent å¹¶å‘è§¦å‘é™æµ | é«˜ | ToolRegistry å†…ç½® RateLimiterï¼ˆ5 QPSï¼‰ï¼Œæ’é˜Ÿæœºåˆ¶ |
| **Reddit API é™åˆ¶** | å…è´¹å±‚æ¯åˆ†é’Ÿ 60 è¯·æ±‚ | ä¸­ | ç¼“å­˜ç­–ç•¥ + æŒ‰éœ€è°ƒç”¨ + é™çº§åˆ° web_search |
| **Twitter æ•°æ®è·å–å›°éš¾** | API ä»˜è´¹é—¨æ§›é«˜ | é«˜ | ä¼˜å…ˆä½¿ç”¨é—´æ¥æ–¹å¼ï¼ˆweb_search + site:twitter.comï¼‰ |
| **Supervisor ç“¶é¢ˆ** | ä¸­å¤®è°ƒåº¦å™¨æˆä¸ºæ€§èƒ½ç“¶é¢ˆ | ä¸­ | å®ç° `forward_message` ç›´é€šæœºåˆ¶ |
| **Context è†¨èƒ€** | è¾©è®ºå¤šè½®å¯¼è‡´ Token è¶…é™ | é«˜ | åˆ†å±‚è®°å¿† + æ‘˜è¦å‹ç¼© + åªä¿ç•™å…³é”®è´¨ç–‘ |
| **åè°ƒå¼€é”€** | å¤š Agent + è¾©è®ºå¢åŠ å»¶è¿Ÿ | ä¸­ | å¹¶è¡Œæ‰§è¡Œæ— ä¾èµ–ä»»åŠ¡ï¼Œè¾©è®ºè½®æ¬¡å¯é…ç½® |
| **é”™è¯¯ä¼ æ’­** | å• Agent å¤±è´¥å½±å“å…¨æµç¨‹ | ä¸­ | ç†”æ–­æœºåˆ¶ + é™çº§ç­–ç•¥ + é‡è¯•é€»è¾‘ |
| **SSE ä»£ç†ç¼“å†²** | å‰ç«¯é•¿æ—¶é—´æ— å¢é‡æ›´æ–°ï¼Œè¯¯åˆ¤â€œå¡ä½â€ | ä¸­ | è®¾ç½® `X-Accel-Buffering: no`ï¼Œç¦ç”¨ SSE è·¯å¾„å‹ç¼©ï¼Œå¢åŠ å¿ƒè·³äº‹ä»¶ |
| **SSE è¿æ¥ä¸Šé™ï¼ˆHTTP/1.1ï¼‰** | å¤šæ ‡ç­¾é¡µå¹¶å‘æ—¶è¿æ¥è¢«æŠ¢å æˆ–ä¸­æ–­ | ä¸­ | æ§åˆ¶å¹¶å‘è¿æ¥ã€å¤ç”¨ä¼šè¯æµã€ä¼˜å…ˆä½¿ç”¨ HTTP/2 |
| **å¤æ‚æ€§å¢åŠ ** | ç»´æŠ¤æˆæœ¬ä¸Šå‡ | é«˜ | å®Œå–„æ–‡æ¡£ + å•å…ƒæµ‹è¯• + å¯è§‚æµ‹æ€§å·¥å…· |

---

## å…«ã€éªŒæ”¶æ ‡å‡†

### 8.1 Phase 1 éªŒæ”¶æ ‡å‡†

- [x] åç«¯ä»£ç æŒ‰æ–°ç›®å½•ç»“æ„ç»„ç»‡ï¼ˆæ—  validation/v1 æ¨¡å—ï¼‰
- [x] BaseAgent æŠ½è±¡ç±»å¯è¢«å­ç±»æ­£ç¡®ç»§æ‰¿
- [x] å‰ç«¯å…¨å±€çŠ¶æ€ç”± Context + Reducer ç®¡ç†ï¼ˆæ—  validation ç›¸å…³ï¼‰
- [x] æœ¬åœ° Supabase/Postgres æ•°æ®è¡¨å¯æ­£å¸¸ CRUDï¼ˆsessions/agent_results/debate_exchanges/workflow_eventsï¼‰
- [x] IGraphEngine æ¥å£å®šä¹‰å®Œæˆ
- [x] SSE äº‹ä»¶åè®®å®šä¹‰å®Œæˆï¼ˆå« debate_* äº‹ä»¶ï¼‰
- [x] `/api/v2/market-insight/stream` å¯è·‘é€šå¹¶è¿”å› `orchestrator_end.final_report`
- [x] è§¦å‘ä¸€æ¬¡å·¥ä½œæµåï¼Œå…³é”®çŠ¶æ€ä¸ç»“æœèƒ½è½åº“ï¼ˆsessions/agent_results/debate_exchanges/workflow_events å¯æŸ¥è¯¢ï¼‰

### 8.2 Phase 2 éªŒæ”¶æ ‡å‡†

- [x] Orchestrator èƒ½æ­£ç¡®åˆ†è§£ç”¨æˆ·è¯·æ±‚
- [x] 4 ä¸ªå¸‚åœºæ´å¯Ÿå­ Agent å¯å¹¶è¡Œæ‰§è¡Œ
- [x] SocialSentinel åŸºäº Ark `web_search` å¯ç¨³å®šè¾“å‡ºç¤¾åª’æ´å¯Ÿï¼ˆReddit API ç›´è¿åç½®åˆ° Phase 4ï¼‰
- [x] DebateCoordinator èƒ½åè°ƒ 2-3 è½®è¾©è®º
- [x] è¾©è®ºè¿‡ç¨‹ä¸­ Agent èƒ½æå‡ºè´¨ç–‘å¹¶å›åº”
- [x] æœ€ç»ˆè¾“å‡ºåŒ…å«å…±è¯†ç»“è®ºä¸åˆ†æ­§æ ‡æ³¨ï¼ˆç”± Synthesizer ç»“æ„åŒ–è¾“å‡ºï¼‰
- [x] Orchestrator æ”¯æŒèŠ‚ç‚¹çº§é‡è¯•/é™çº§
- [x] é‡è¯•è€—å°½åå¯æŒ‰ç­–ç•¥é™çº§ï¼ˆ`skip` / `partial` / `fail`ï¼‰å¹¶æœ‰å¯è¿½è¸ªäº‹ä»¶
- [x] Agent æ‰§è¡ŒçŠ¶æ€æ­£ç¡®è®°å½•åˆ° Supabase/Postgres
- [x] æµå¼è¾“å‡ºåŒ…å«è¾©è®ºç”Ÿå‘½å‘¨æœŸäº‹ä»¶
- [x] SSE åœ¨"å®¢æˆ·ç«¯ä¸­æ–­é‡è¿ + åå‘ä»£ç†ç¼“å†²å…³é—­"åœºæ™¯ä¸‹ç¨³å®š
- [x] æœ€ç»ˆæŠ¥å‘Šè´¨é‡ä¸ä½äºåŸå•ä½“ Agent

### 8.3 Phase 3 éªŒæ”¶æ ‡å‡†

- [ ] ä»»æ„ `session_id` å‡å¯ç”Ÿæˆ Evidence Packï¼ˆå«æ¥æºã€ç»“è®ºã€ç½®ä¿¡åº¦ã€æ—¶é—´æˆ³ï¼‰
- [ ] è‡³å°‘ 10 ç»„æ ‡å‡†æ ·æœ¬å¯é€šè¿‡è„šæœ¬ä¸€é”®å›æ”¾å¹¶ç”Ÿæˆç»“æœå¿«ç…§
- [ ] `/status/{session_id}` å¯å›è¡¥è½»é‡è®°å¿†å¿«ç…§ï¼ˆå…³é”®å®ä½“/ç»“è®ºï¼‰
- [ ] å…³é”®ç»“è®ºå¯è¿½æº¯åˆ° Agent ä¸æ¥æºé“¾æ¥ï¼ˆæ»¡è¶³è¯„å®¡è¿½é—®ï¼‰
- [ ] ï¼ˆStretchï¼‰Supabase Realtime / Checkpoint æ·±åŒ–èƒ½åŠ›å¯æ¼”ç¤º

### 8.4 Phase 4 éªŒæ”¶æ ‡å‡†

- [ ] ToolRegistry Lite æ¥ç®¡å½“å‰ `web_search` è°ƒç”¨è·¯å¾„ï¼ˆé»˜è®¤è·¯å¾„ 100% è¦†ç›–ï¼‰
- [ ] å¯æŒ‰ session/agent è¾“å‡ºè€—æ—¶ã€é”™è¯¯ç‡ä¸æˆæœ¬ç»Ÿè®¡
- [ ] æˆæœ¬æŠ¤æ ç”Ÿæ•ˆï¼šè¶…æ—¶/å¤±è´¥è§¦å‘é™çº§åæµç¨‹ä»å¯äº§å‡ºå¯è¯»æŠ¥å‘Š
- [ ] ç¼“å­˜ä¸æ¨¡æ¿ç­–ç•¥å¯é™ä½é‡å¤æ¼”ç¤ºæ³¢åŠ¨
- [ ] ï¼ˆStretchï¼‰`reddit_api` åœ¨ Feature Flag å¼€å¯æ—¶å¯ç”¨ï¼Œå…³é—­æ—¶è‡ªåŠ¨å›é€€
- [ ] å·¥å…·ä¸é™çº§ç­–ç•¥æ–‡æ¡£å®Œæ•´ï¼ˆä¾¿äºç­”è¾©è§£é‡Šï¼‰

### 8.5 Phase 5 éªŒæ”¶æ ‡å‡†

- [ ] è¯„å§”æ¨¡å¼ä¸‰å¥—åœºæ™¯ï¼ˆ60 ç§’/3 åˆ†é’Ÿ/æ·±åº¦ï¼‰å¯ä¸€é”®è·‘é€š
- [ ] é¡µé¢å¯è§†åŒ–å®Œæ•´å±•ç¤º Agentã€è¾©è®ºã€é™çº§çŠ¶æ€ä¸æŠ¥å‘Šä¸‹è½½
- [ ] å¼±ç½‘æˆ–ä¸­æ–­æƒ…å†µä¸‹å¯åœ¨ 90 ç§’å†…é€šè¿‡çŠ¶æ€æ¥å£æ¢å¤å±•ç¤º
- [ ] ä¸€é”®å¯¼å‡ºè·¯æ¼”åŒ…å¯ç›´æ¥ç”¨äºæ¯”èµ›å±•ç¤º
- [ ] ç»¼åˆæŠ¥å‘Šæ”¯æŒå…³é”®å›¾è¡¨å¢å¼ºï¼ˆVega-Liteï¼‰ï¼Œä¸”ä¿æŒæ­£æ–‡ç»“æ„ä¸ä¿¡æ¯å®Œæ•´
- [ ] å›¾è¡¨åœ¨å‰ç«¯å®æ—¶é¡µä¸å¯¼å‡º HTML å‡å¯æ¸²æŸ“ï¼›æ¸²æŸ“å¤±è´¥æ—¶è‡ªåŠ¨å›é€€ä¸ºå¯è¯»æ–‡æœ¬/åŸå§‹é…ç½®
- [ ] å®Œæˆè‡³å°‘ 3 è½®å®Œæ•´å½©æ’å¹¶å½¢æˆé—®é¢˜æ¸…å•ä¸ä¿®å¤é—­ç¯

---

## ä¹ã€æ—¶é—´çº¿æ€»è§ˆ

```
Week 1-2: Phase 1 - åŸºç¡€æ¶æ„é‡æ„
  â””â”€ æ¨¡å—æ‹†åˆ† + BaseAgent + Supabase + IGraphEngine + äº‹ä»¶åè®®

Week 3-4.5: Phase 2 - å¤š Agent åä½œ
  â””â”€ Orchestrator + Market Swarm (4 Agent) + DebateCoordinator

Week 5: Phase 3 - æ¯”èµ›è¯æ®å±‚ï¼ˆMustï¼‰
  â””â”€ Evidence Pack + è½»é‡è®°å¿†å¿«ç…§ + 10~20 ç»„å›æ”¾æ ·æœ¬

Week 6: Phase 4 - å·¥å…·å±‚æ”¶æ•›ï¼ˆMustï¼‰
  â””â”€ ToolRegistry Lite + æˆæœ¬éŸ§æ€§ + é™çº§è”åŠ¨

Week 7: Phase 5 - å‚èµ›æ¼”ç¤ºåŒ…è£…ï¼ˆMustï¼‰
  â””â”€ è¯„å§”æ¨¡å¼ + æŒ‡æ ‡çœ‹æ¿ + ä¸€é”®å¯¼å‡ºè·¯æ¼”åŒ… + å›¾è¡¨å¢å¼ºæŠ¥å‘Š

Week 8: å¼¹æ€§ç¼“å†²ï¼ˆStretch + å½©æ’ï¼‰
  â””â”€ Reddit é€‚é…å™¨/Realtime å¼ºåŒ– + å…¨é“¾è·¯å½©æ’ + å†»ç»“ç‰ˆæœ¬
```

---

## åã€é™„å½•
### C. å‚è€ƒèµ„æº

- [LangGraph Documentation](https://docs.langchain.com/oss/python/langgraph/overview) - å›¾ç¼–æ’ã€çŠ¶æ€è·¯ç”±ã€checkpoint
- [LangGraph RetryPolicyï¼ˆæ¦‚å¿µ/ç¤ºä¾‹ï¼‰](https://docs.langchain.com/oss/python/langgraph/overview) - èŠ‚ç‚¹çº§é‡è¯•èƒ½åŠ›ï¼ˆé‡è¯•è€—å°½éœ€ä¸šåŠ¡ä¾§é™çº§ï¼‰
- [Supabase Documentation](https://supabase.com/docs) - æ•°æ®åº“ä¸ Realtime
- [Supabase RLS](https://supabase.com/docs/guides/database/postgres/row-level-security) - RLS ç­–ç•¥ä¸å¼€å‘/ç”Ÿäº§å·®å¼‚
- [PRAW Documentation](https://praw.readthedocs.io/) - Reddit API
- [FastAPI Streaming](https://fastapi.tiangolo.com/advanced/custom-response/#streamingresponse) - æµå¼å“åº”
- [Starlette Responses](https://www.starlette.io/responses/) - `StreamingResponse` ä¸ SSE ç¬¬ä¸‰æ–¹å®ç°è¯´æ˜
- [sse-starlette](https://github.com/sysid/sse-starlette) - `EventSourceResponse` å‚è€ƒå®ç°
- [MDN SSE](https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events) - SSE åè®®æ ¼å¼ä¸é‡è¿è¡Œä¸º
- [PostgreSQL INSERT](https://www.postgresql.org/docs/current/sql-insert.html) - `ON CONFLICT` åŸå­ upsert è¯­ä¹‰
- [React Context](https://react.dev/reference/react/useContext) - çŠ¶æ€ç®¡ç†

---

> **æ–‡æ¡£ç»´æŠ¤**: æœ¬æ–‡æ¡£å°†éšé¡¹ç›®è¿›å±•æŒç»­æ›´æ–°  
> **ç‰ˆæœ¬å†å²**:
> - v1.0 (2026-02-07): åˆå§‹ç‰ˆæœ¬
> - v2.0 (2026-02-07): åˆ é™¤ Data Validation Swarmï¼Œæ–°å¢å¤šè½®è¾©è®ºæœºåˆ¶ä¸ç¤¾äº¤èˆ†æƒ…æ•°æ®æº
> - v2.1 (2026-02-07): è¡¥å¼º P1-6 èŒƒå›´æ§åˆ¶ã€RLS ç­–ç•¥ã€å¹‚ç­‰é”®è§„åˆ™ã€IGraphEngine æ¥å£å®šä¹‰
> - v2.2 (2026-02-08): æ–°å¢ Agent è§’è‰²æ¨¡å‹è®¾å®šï¼ˆ2.3 Agent-Model æ˜ å°„ + 2.4 è§’è‰²è¯¦ç»†è®¾å®š + 2.5 è¾©è®ºæœºåˆ¶ç»†åŒ– + 3.3 Ark API è°ƒç”¨è§„èŒƒï¼‰
> - v2.3 (2026-02-10): å®Œæˆ Phase 1 å¯éªŒæ”¶é—­ç¯ï¼ˆæœ¬åœ° Supabase/Postgres + 002/003 è¿ç§» + SSE æœ€å°è½åº“ + /status æŸ¥è¯¢ï¼‰ï¼›ä»“åº“ä¸“æ³¨ Market Insight v2
> - v2.4 (2026-02-11): è°ƒæ•´ Phase 2 éªŒæ”¶å£å¾„ï¼ŒReddit API ç›´è¿åç½®åˆ° Phase 4ï¼ˆP4-3/P4-4ï¼‰ï¼ŒPhase 2 ä»¥ Ark `web_search` ç¤¾åª’æ´å¯Ÿä¸ºå‡†
> - v2.5 (2026-02-12): æ ¹æ®å®˜æ–¹æ–‡æ¡£è¡¥å…… Phase 2 æ”¶å£é¡¹ï¼ˆé‡è¯•è€—å°½é™çº§ç­–ç•¥ã€SSE æ–­è¿æ¢å¤ä¸ä»£ç†ç¼“å†²å…¼å®¹æ€§éªŒæ”¶ï¼‰ï¼Œå¹¶æ›´æ–°å‚è€ƒé“¾æ¥
> - v2.6 (2026-02-13): è¡¥å…… Phase 2 æ”¶å£å®æµ‹è®°å½•ï¼ˆ`debate_rounds` è·¯ç”±ã€æ–­è¿æ¢å¤ã€è½åº“æ ¡éªŒã€UUID æ³¨æ„äº‹é¡¹ä¸ Ark å¶å‘è¿æ¥æ³¢åŠ¨è¯´æ˜ï¼‰
> - v2.7 (2026-02-15): æŒ‰â€œåˆ›ä¸šæ¯”èµ›äº¤ä»˜â€é‡æ’ Phase 3/4/5ï¼šå¼•å…¥ Must/Stretch å¼¹æ€§ç­–ç•¥ï¼Œä¼˜å…ˆè¯æ®é“¾ã€æˆæœ¬éŸ§æ€§ä¸è·¯æ¼”æ¼”ç¤ºåŒ…è£…
> - v2.8 (2026-02-16): æ˜ç¡®å°†â€œç»¼åˆæŠ¥å‘Šå›¾è¡¨å¢å¼ºâ€åç½®è‡³ Phase 5ï¼šé‡‡ç”¨ Vega-Liteï¼Œåœ¨ä¿æŒæ­£æ–‡å®Œæ•´æ€§çš„å‰æä¸‹å®ç°å‰ç«¯å®æ—¶é¡µ + å¯¼å‡º HTML åŒç«¯å¯è§†åŒ–ï¼Œå¹¶è¦æ±‚æ¸²æŸ“å¤±è´¥è‡ªåŠ¨å›é€€
